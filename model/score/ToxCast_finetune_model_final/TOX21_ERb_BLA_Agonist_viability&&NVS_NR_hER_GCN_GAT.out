[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GCN_GAT...
  * Pretrained model already exists at model_save/pretrained/gcn_gat/Pretrained_TOX21_ERb_BLA_Agonist_viability_gcn_gat.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GCN_GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6383 - Val F1: 0.4286 - Val ROC-AUC: 0.6880 - Val PR-AUC: 0.3496
[Fine-tune] Epoch 2/50 - Loss: 0.5860 - Val F1: 0.3793 - Val ROC-AUC: 0.7346 - Val PR-AUC: 0.4797
[Fine-tune] Epoch 3/50 - Loss: 0.5397 - Val F1: 0.4878 - Val ROC-AUC: 0.7632 - Val PR-AUC: 0.5993
[Fine-tune] Epoch 4/50 - Loss: 0.4998 - Val F1: 0.4800 - Val ROC-AUC: 0.7632 - Val PR-AUC: 0.5681
[Fine-tune] Epoch 5/50 - Loss: 0.4687 - Val F1: 0.3733 - Val ROC-AUC: 0.7599 - Val PR-AUC: 0.5922
[Fine-tune] Epoch 6/50 - Loss: 0.4454 - Val F1: 0.4533 - Val ROC-AUC: 0.7610 - Val PR-AUC: 0.5648
[Fine-tune] Epoch 7/50 - Loss: 0.4773 - Val F1: 0.5000 - Val ROC-AUC: 0.7555 - Val PR-AUC: 0.6194
[Fine-tune] Epoch 8/50 - Loss: 0.4528 - Val F1: 0.3750 - Val ROC-AUC: 0.7511 - Val PR-AUC: 0.5655
[Fine-tune] Epoch 9/50 - Loss: 0.4506 - Val F1: 0.4000 - Val ROC-AUC: 0.7319 - Val PR-AUC: 0.5134
[Fine-tune] Epoch 10/50 - Loss: 0.4414 - Val F1: 0.3704 - Val ROC-AUC: 0.7412 - Val PR-AUC: 0.5343
[Fine-tune] Epoch 11/50 - Loss: 0.4505 - Val F1: 0.4561 - Val ROC-AUC: 0.7834 - Val PR-AUC: 0.6242
[Fine-tune] Epoch 12/50 - Loss: 0.4262 - Val F1: 0.4815 - Val ROC-AUC: 0.7478 - Val PR-AUC: 0.6038
[Fine-tune] Epoch 13/50 - Loss: 0.3751 - Val F1: 0.4762 - Val ROC-AUC: 0.7741 - Val PR-AUC: 0.5847
[Fine-tune] Epoch 14/50 - Loss: 0.3620 - Val F1: 0.4286 - Val ROC-AUC: 0.7363 - Val PR-AUC: 0.5371
[Fine-tune] Epoch 15/50 - Loss: 0.3814 - Val F1: 0.5128 - Val ROC-AUC: 0.7675 - Val PR-AUC: 0.6079
[Fine-tune] Epoch 16/50 - Loss: 0.3711 - Val F1: 0.4151 - Val ROC-AUC: 0.7791 - Val PR-AUC: 0.6094
[Fine-tune] Epoch 17/50 - Loss: 0.3678 - Val F1: 0.4878 - Val ROC-AUC: 0.7527 - Val PR-AUC: 0.5648
[Fine-tune] Epoch 18/50 - Loss: 0.3992 - Val F1: 0.3922 - Val ROC-AUC: 0.7412 - Val PR-AUC: 0.5934
[Fine-tune] Epoch 19/50 - Loss: 0.3948 - Val F1: 0.5000 - Val ROC-AUC: 0.7812 - Val PR-AUC: 0.6247
[Fine-tune] Epoch 20/50 - Loss: 0.3421 - Val F1: 0.5000 - Val ROC-AUC: 0.7692 - Val PR-AUC: 0.6148
[Fine-tune] Epoch 21/50 - Loss: 0.3966 - Val F1: 0.5405 - Val ROC-AUC: 0.7495 - Val PR-AUC: 0.6163
[Fine-tune] Epoch 22/50 - Loss: 0.3564 - Val F1: 0.4528 - Val ROC-AUC: 0.7714 - Val PR-AUC: 0.5974
[Fine-tune] Epoch 23/50 - Loss: 0.3549 - Val F1: 0.4314 - Val ROC-AUC: 0.7664 - Val PR-AUC: 0.5882
[Fine-tune] Epoch 24/50 - Loss: 0.3725 - Val F1: 0.4286 - Val ROC-AUC: 0.7412 - Val PR-AUC: 0.5664
[Fine-tune] Epoch 25/50 - Loss: 0.3440 - Val F1: 0.3774 - Val ROC-AUC: 0.7346 - Val PR-AUC: 0.5318
[Fine-tune] Epoch 26/50 - Loss: 0.3406 - Val F1: 0.4167 - Val ROC-AUC: 0.7473 - Val PR-AUC: 0.5233
[Fine-tune] Epoch 27/50 - Loss: 0.3242 - Val F1: 0.4082 - Val ROC-AUC: 0.7467 - Val PR-AUC: 0.5029
[Fine-tune] Epoch 28/50 - Loss: 0.3788 - Val F1: 0.4681 - Val ROC-AUC: 0.7560 - Val PR-AUC: 0.6157
[Fine-tune] Epoch 29/50 - Loss: 0.3490 - Val F1: 0.4651 - Val ROC-AUC: 0.7577 - Val PR-AUC: 0.5893
[Fine-tune] Epoch 30/50 - Loss: 0.3410 - Val F1: 0.4490 - Val ROC-AUC: 0.7566 - Val PR-AUC: 0.5988
[Fine-tune] Epoch 31/50 - Loss: 0.3305 - Val F1: 0.4167 - Val ROC-AUC: 0.7555 - Val PR-AUC: 0.6039
[Fine-tune] Epoch 32/50 - Loss: 0.3246 - Val F1: 0.4681 - Val ROC-AUC: 0.7527 - Val PR-AUC: 0.5750
[Fine-tune] Epoch 33/50 - Loss: 0.3117 - Val F1: 0.4444 - Val ROC-AUC: 0.7588 - Val PR-AUC: 0.5961
[Fine-tune] Epoch 34/50 - Loss: 0.3390 - Val F1: 0.4681 - Val ROC-AUC: 0.7681 - Val PR-AUC: 0.6169
[Fine-tune] Epoch 35/50 - Loss: 0.3718 - Val F1: 0.4444 - Val ROC-AUC: 0.7549 - Val PR-AUC: 0.5386
[Fine-tune] Epoch 36/50 - Loss: 0.3328 - Val F1: 0.4167 - Val ROC-AUC: 0.7434 - Val PR-AUC: 0.5395
[Fine-tune] Epoch 37/50 - Loss: 0.2933 - Val F1: 0.4314 - Val ROC-AUC: 0.7571 - Val PR-AUC: 0.5758
[Fine-tune] Epoch 38/50 - Loss: 0.3084 - Val F1: 0.4400 - Val ROC-AUC: 0.7522 - Val PR-AUC: 0.5685
[Fine-tune] Epoch 39/50 - Loss: 0.3327 - Val F1: 0.4681 - Val ROC-AUC: 0.7604 - Val PR-AUC: 0.6033
[Fine-tune] Epoch 40/50 - Loss: 0.3029 - Val F1: 0.4348 - Val ROC-AUC: 0.7511 - Val PR-AUC: 0.5568
[Fine-tune] Epoch 41/50 - Loss: 0.3368 - Val F1: 0.4348 - Val ROC-AUC: 0.7473 - Val PR-AUC: 0.5537
[Fine-tune] Epoch 42/50 - Loss: 0.2980 - Val F1: 0.4681 - Val ROC-AUC: 0.7544 - Val PR-AUC: 0.5616
[Fine-tune] Epoch 43/50 - Loss: 0.3117 - Val F1: 0.4681 - Val ROC-AUC: 0.7582 - Val PR-AUC: 0.5859
[Fine-tune] Epoch 44/50 - Loss: 0.3178 - Val F1: 0.4348 - Val ROC-AUC: 0.7489 - Val PR-AUC: 0.5676
[Fine-tune] Epoch 45/50 - Loss: 0.3065 - Val F1: 0.4348 - Val ROC-AUC: 0.7489 - Val PR-AUC: 0.5476
[Fine-tune] Epoch 46/50 - Loss: 0.2968 - Val F1: 0.4490 - Val ROC-AUC: 0.7533 - Val PR-AUC: 0.5471
[Fine-tune] Epoch 47/50 - Loss: 0.3121 - Val F1: 0.4082 - Val ROC-AUC: 0.7368 - Val PR-AUC: 0.5339
[Fine-tune] Epoch 48/50 - Loss: 0.2985 - Val F1: 0.4255 - Val ROC-AUC: 0.7462 - Val PR-AUC: 0.5484
[Fine-tune] Epoch 49/50 - Loss: 0.3024 - Val F1: 0.4681 - Val ROC-AUC: 0.7516 - Val PR-AUC: 0.5686
[Fine-tune] Epoch 50/50 - Loss: 0.3099 - Val F1: 0.4583 - Val ROC-AUC: 0.7527 - Val PR-AUC: 0.5596
Finetuning completed. Test F1: 0.5238, ROC-AUC: 0.7211, PR-AUC: 0.4267
[3.1/4] Target-only training on NVS_NR_hER using GCN_GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gcn_gat/TargetOnly_NVS_NR_hER_gcn_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.4878, ROC-AUC: 0.7374, PR-AUC: 0.4462
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> NVS_NR_hER [GCN_GAT]
