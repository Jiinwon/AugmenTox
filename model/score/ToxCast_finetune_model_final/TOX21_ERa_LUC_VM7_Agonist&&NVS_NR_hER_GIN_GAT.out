[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERa_LUC_VM7_Agonist using GIN_GAT...
  * Pretrained model already exists at model_save/pretrained/gin_gat/Pretrained_TOX21_ERa_LUC_VM7_Agonist_gin_gat.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GIN_GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.5887 - Val F1: 0.4000 - Val ROC-AUC: 0.7500 - Val PR-AUC: 0.4237
[Fine-tune] Epoch 2/50 - Loss: 0.4490 - Val F1: 0.4255 - Val ROC-AUC: 0.7763 - Val PR-AUC: 0.5554
[Fine-tune] Epoch 3/50 - Loss: 0.3750 - Val F1: 0.4348 - Val ROC-AUC: 0.7675 - Val PR-AUC: 0.5827
[Fine-tune] Epoch 4/50 - Loss: 0.3357 - Val F1: 0.4400 - Val ROC-AUC: 0.7385 - Val PR-AUC: 0.5461
[Fine-tune] Epoch 5/50 - Loss: 0.3518 - Val F1: 0.4706 - Val ROC-AUC: 0.7588 - Val PR-AUC: 0.5072
[Fine-tune] Epoch 6/50 - Loss: 0.3356 - Val F1: 0.5238 - Val ROC-AUC: 0.7950 - Val PR-AUC: 0.6315
[Fine-tune] Epoch 7/50 - Loss: 0.2909 - Val F1: 0.5143 - Val ROC-AUC: 0.7851 - Val PR-AUC: 0.6173
[Fine-tune] Epoch 8/50 - Loss: 0.2887 - Val F1: 0.4390 - Val ROC-AUC: 0.7566 - Val PR-AUC: 0.5236
[Fine-tune] Epoch 9/50 - Loss: 0.3211 - Val F1: 0.3793 - Val ROC-AUC: 0.7533 - Val PR-AUC: 0.5016
[Fine-tune] Epoch 10/50 - Loss: 0.2651 - Val F1: 0.4651 - Val ROC-AUC: 0.7538 - Val PR-AUC: 0.5343
[Fine-tune] Epoch 11/50 - Loss: 0.2503 - Val F1: 0.4444 - Val ROC-AUC: 0.7648 - Val PR-AUC: 0.5937
[Fine-tune] Epoch 12/50 - Loss: 0.1924 - Val F1: 0.4878 - Val ROC-AUC: 0.7495 - Val PR-AUC: 0.5340
[Fine-tune] Epoch 13/50 - Loss: 0.2098 - Val F1: 0.4348 - Val ROC-AUC: 0.7686 - Val PR-AUC: 0.4471
[Fine-tune] Epoch 14/50 - Loss: 0.1774 - Val F1: 0.4783 - Val ROC-AUC: 0.7774 - Val PR-AUC: 0.5769
[Fine-tune] Epoch 15/50 - Loss: 0.1825 - Val F1: 0.4348 - Val ROC-AUC: 0.7604 - Val PR-AUC: 0.5613
[Fine-tune] Epoch 16/50 - Loss: 0.1950 - Val F1: 0.4444 - Val ROC-AUC: 0.7780 - Val PR-AUC: 0.5680
[Fine-tune] Epoch 17/50 - Loss: 0.2122 - Val F1: 0.5000 - Val ROC-AUC: 0.7522 - Val PR-AUC: 0.5551
[Fine-tune] Epoch 18/50 - Loss: 0.1980 - Val F1: 0.5238 - Val ROC-AUC: 0.7626 - Val PR-AUC: 0.5228
[Fine-tune] Epoch 19/50 - Loss: 0.1884 - Val F1: 0.5000 - Val ROC-AUC: 0.7440 - Val PR-AUC: 0.5064
[Fine-tune] Epoch 20/50 - Loss: 0.2035 - Val F1: 0.5000 - Val ROC-AUC: 0.7643 - Val PR-AUC: 0.4877
[Fine-tune] Epoch 21/50 - Loss: 0.1550 - Val F1: 0.5116 - Val ROC-AUC: 0.7467 - Val PR-AUC: 0.5199
[Fine-tune] Epoch 22/50 - Loss: 0.1248 - Val F1: 0.5000 - Val ROC-AUC: 0.7538 - Val PR-AUC: 0.5082
[Fine-tune] Epoch 23/50 - Loss: 0.1719 - Val F1: 0.4390 - Val ROC-AUC: 0.7686 - Val PR-AUC: 0.5235
[Fine-tune] Epoch 24/50 - Loss: 0.1358 - Val F1: 0.4737 - Val ROC-AUC: 0.7429 - Val PR-AUC: 0.5046
[Fine-tune] Epoch 25/50 - Loss: 0.1455 - Val F1: 0.4737 - Val ROC-AUC: 0.7626 - Val PR-AUC: 0.5455
[Fine-tune] Epoch 26/50 - Loss: 0.1358 - Val F1: 0.5500 - Val ROC-AUC: 0.7385 - Val PR-AUC: 0.5334
[Fine-tune] Epoch 27/50 - Loss: 0.1419 - Val F1: 0.5238 - Val ROC-AUC: 0.7566 - Val PR-AUC: 0.4835
[Fine-tune] Epoch 28/50 - Loss: 0.1356 - Val F1: 0.4762 - Val ROC-AUC: 0.7516 - Val PR-AUC: 0.5357
[Fine-tune] Epoch 29/50 - Loss: 0.1512 - Val F1: 0.4651 - Val ROC-AUC: 0.7615 - Val PR-AUC: 0.5587
[Fine-tune] Epoch 30/50 - Loss: 0.1119 - Val F1: 0.4651 - Val ROC-AUC: 0.7445 - Val PR-AUC: 0.5040
[Fine-tune] Epoch 31/50 - Loss: 0.1217 - Val F1: 0.5000 - Val ROC-AUC: 0.7346 - Val PR-AUC: 0.5291
[Fine-tune] Epoch 32/50 - Loss: 0.1130 - Val F1: 0.4762 - Val ROC-AUC: 0.7423 - Val PR-AUC: 0.5565
[Fine-tune] Epoch 33/50 - Loss: 0.1108 - Val F1: 0.4762 - Val ROC-AUC: 0.7533 - Val PR-AUC: 0.5298
[Fine-tune] Epoch 34/50 - Loss: 0.1084 - Val F1: 0.5000 - Val ROC-AUC: 0.7626 - Val PR-AUC: 0.5624
[Fine-tune] Epoch 35/50 - Loss: 0.1248 - Val F1: 0.4390 - Val ROC-AUC: 0.7385 - Val PR-AUC: 0.5323
[Fine-tune] Epoch 36/50 - Loss: 0.0993 - Val F1: 0.4500 - Val ROC-AUC: 0.7484 - Val PR-AUC: 0.5398
[Fine-tune] Epoch 37/50 - Loss: 0.1067 - Val F1: 0.4390 - Val ROC-AUC: 0.7286 - Val PR-AUC: 0.5082
[Fine-tune] Epoch 38/50 - Loss: 0.1050 - Val F1: 0.4762 - Val ROC-AUC: 0.7363 - Val PR-AUC: 0.5402
[Fine-tune] Epoch 39/50 - Loss: 0.1078 - Val F1: 0.4615 - Val ROC-AUC: 0.7516 - Val PR-AUC: 0.5127
[Fine-tune] Epoch 40/50 - Loss: 0.1063 - Val F1: 0.4615 - Val ROC-AUC: 0.7445 - Val PR-AUC: 0.5464
[Fine-tune] Epoch 41/50 - Loss: 0.1281 - Val F1: 0.4878 - Val ROC-AUC: 0.7467 - Val PR-AUC: 0.5151
[Fine-tune] Epoch 42/50 - Loss: 0.1099 - Val F1: 0.4762 - Val ROC-AUC: 0.7478 - Val PR-AUC: 0.5094
[Fine-tune] Epoch 43/50 - Loss: 0.0975 - Val F1: 0.4651 - Val ROC-AUC: 0.7495 - Val PR-AUC: 0.5002
[Fine-tune] Epoch 44/50 - Loss: 0.1091 - Val F1: 0.4651 - Val ROC-AUC: 0.7500 - Val PR-AUC: 0.5109
[Fine-tune] Epoch 45/50 - Loss: 0.1188 - Val F1: 0.4878 - Val ROC-AUC: 0.7467 - Val PR-AUC: 0.5065
[Fine-tune] Epoch 46/50 - Loss: 0.0961 - Val F1: 0.4651 - Val ROC-AUC: 0.7412 - Val PR-AUC: 0.5063
[Fine-tune] Epoch 47/50 - Loss: 0.0793 - Val F1: 0.4651 - Val ROC-AUC: 0.7385 - Val PR-AUC: 0.5170
[Fine-tune] Epoch 48/50 - Loss: 0.0994 - Val F1: 0.4651 - Val ROC-AUC: 0.7357 - Val PR-AUC: 0.5161
[Fine-tune] Epoch 49/50 - Loss: 0.1007 - Val F1: 0.4651 - Val ROC-AUC: 0.7379 - Val PR-AUC: 0.4938
[Fine-tune] Epoch 50/50 - Loss: 0.0927 - Val F1: 0.4651 - Val ROC-AUC: 0.7352 - Val PR-AUC: 0.5045
Finetuning completed. Test F1: 0.5366, ROC-AUC: 0.6972, PR-AUC: 0.4681
[3.1/4] Target-only training on NVS_NR_hER using GIN_GAT...
=== Target-only training ===
[Target-only] Epoch 1/50 – Loss: 0.6293  Val F1: 0.0000  ROC-AUC: 0.7061  PR-AUC: 0.3591
[Target-only] Epoch 2/50 – Loss: 0.5508  Val F1: 0.5128  ROC-AUC: 0.7703  PR-AUC: 0.5752
[Target-only] Epoch 3/50 – Loss: 0.5257  Val F1: 0.3824  ROC-AUC: 0.7100  PR-AUC: 0.4734
[Target-only] Epoch 4/50 – Loss: 0.5135  Val F1: 0.4062  ROC-AUC: 0.7281  PR-AUC: 0.5597
[Target-only] Epoch 5/50 – Loss: 0.5026  Val F1: 0.4000  ROC-AUC: 0.7478  PR-AUC: 0.5605
[Target-only] Epoch 6/50 – Loss: 0.4903  Val F1: 0.4561  ROC-AUC: 0.7769  PR-AUC: 0.6265
[Target-only] Epoch 7/50 – Loss: 0.4554  Val F1: 0.5500  ROC-AUC: 0.8141  PR-AUC: 0.6571
[Target-only] Epoch 8/50 – Loss: 0.4626  Val F1: 0.4583  ROC-AUC: 0.7593  PR-AUC: 0.5451
[Target-only] Epoch 9/50 – Loss: 0.4652  Val F1: 0.3846  ROC-AUC: 0.7681  PR-AUC: 0.5649
[Target-only] Epoch 10/50 – Loss: 0.4425  Val F1: 0.3409  ROC-AUC: 0.7078  PR-AUC: 0.4773
[Target-only] Epoch 11/50 – Loss: 0.4255  Val F1: 0.3793  ROC-AUC: 0.7538  PR-AUC: 0.5299
[Target-only] Epoch 12/50 – Loss: 0.3827  Val F1: 0.4561  ROC-AUC: 0.7708  PR-AUC: 0.5784
[Target-only] Epoch 13/50 – Loss: 0.4019  Val F1: 0.4074  ROC-AUC: 0.7714  PR-AUC: 0.6023
[Target-only] Epoch 14/50 – Loss: 0.3781  Val F1: 0.4444  ROC-AUC: 0.7840  PR-AUC: 0.6255
[Target-only] Epoch 15/50 – Loss: 0.3344  Val F1: 0.4400  ROC-AUC: 0.7346  PR-AUC: 0.4962
[Target-only] Epoch 16/50 – Loss: 0.3093  Val F1: 0.5000  ROC-AUC: 0.7884  PR-AUC: 0.6023
[Target-only] Epoch 17/50 – Loss: 0.3243  Val F1: 0.4286  ROC-AUC: 0.7500  PR-AUC: 0.4493
[Target-only] Epoch 18/50 – Loss: 0.3051  Val F1: 0.3860  ROC-AUC: 0.7807  PR-AUC: 0.5738
[Target-only] Epoch 19/50 – Loss: 0.3386  Val F1: 0.4400  ROC-AUC: 0.7374  PR-AUC: 0.4317
[Target-only] Epoch 20/50 – Loss: 0.3153  Val F1: 0.4000  ROC-AUC: 0.7533  PR-AUC: 0.5570
[Target-only] Epoch 21/50 – Loss: 0.2954  Val F1: 0.4400  ROC-AUC: 0.7812  PR-AUC: 0.5831
[Target-only] Epoch 22/50 – Loss: 0.2876  Val F1: 0.4651  ROC-AUC: 0.7845  PR-AUC: 0.5848
[Target-only] Epoch 23/50 – Loss: 0.2778  Val F1: 0.4400  ROC-AUC: 0.7741  PR-AUC: 0.5783
[Target-only] Epoch 24/50 – Loss: 0.2471  Val F1: 0.4286  ROC-AUC: 0.7538  PR-AUC: 0.5165
[Target-only] Epoch 25/50 – Loss: 0.2191  Val F1: 0.5556  ROC-AUC: 0.7774  PR-AUC: 0.5313
[Target-only] Epoch 26/50 – Loss: 0.3096  Val F1: 0.4727  ROC-AUC: 0.7692  PR-AUC: 0.5214
[Target-only] Epoch 27/50 – Loss: 0.2480  Val F1: 0.4800  ROC-AUC: 0.7796  PR-AUC: 0.5678
[Target-only] Epoch 28/50 – Loss: 0.2336  Val F1: 0.4444  ROC-AUC: 0.7659  PR-AUC: 0.5221
[Target-only] Epoch 29/50 – Loss: 0.2273  Val F1: 0.4545  ROC-AUC: 0.7544  PR-AUC: 0.5270
[Target-only] Epoch 30/50 – Loss: 0.2295  Val F1: 0.4681  ROC-AUC: 0.7571  PR-AUC: 0.5209
[Target-only] Epoch 31/50 – Loss: 0.2362  Val F1: 0.5455  ROC-AUC: 0.7681  PR-AUC: 0.5292
[Target-only] Epoch 32/50 – Loss: 0.1925  Val F1: 0.4898  ROC-AUC: 0.7544  PR-AUC: 0.4841
[Target-only] Epoch 33/50 – Loss: 0.2192  Val F1: 0.5000  ROC-AUC: 0.7632  PR-AUC: 0.5070
[Target-only] Epoch 34/50 – Loss: 0.1755  Val F1: 0.4545  ROC-AUC: 0.7621  PR-AUC: 0.5396
[Target-only] Epoch 35/50 – Loss: 0.1768  Val F1: 0.4444  ROC-AUC: 0.7511  PR-AUC: 0.4881
[Target-only] Epoch 36/50 – Loss: 0.1794  Val F1: 0.5128  ROC-AUC: 0.7368  PR-AUC: 0.4702
[Target-only] Epoch 37/50 – Loss: 0.1892  Val F1: 0.4286  ROC-AUC: 0.7527  PR-AUC: 0.4837
[Target-only] Epoch 38/50 – Loss: 0.1839  Val F1: 0.4400  ROC-AUC: 0.7456  PR-AUC: 0.4956
[Target-only] Epoch 39/50 – Loss: 0.1862  Val F1: 0.5000  ROC-AUC: 0.7730  PR-AUC: 0.4725
[Target-only] Epoch 40/50 – Loss: 0.1834  Val F1: 0.5106  ROC-AUC: 0.7670  PR-AUC: 0.5033
[Target-only] Epoch 41/50 – Loss: 0.1631  Val F1: 0.5000  ROC-AUC: 0.7741  PR-AUC: 0.5056
[Target-only] Epoch 42/50 – Loss: 0.1702  Val F1: 0.4583  ROC-AUC: 0.7533  PR-AUC: 0.4803
[Target-only] Epoch 43/50 – Loss: 0.1882  Val F1: 0.4681  ROC-AUC: 0.7593  PR-AUC: 0.4755
[Target-only] Epoch 44/50 – Loss: 0.1657  Val F1: 0.4545  ROC-AUC: 0.7571  PR-AUC: 0.5292
[Target-only] Epoch 45/50 – Loss: 0.1726  Val F1: 0.5000  ROC-AUC: 0.7692  PR-AUC: 0.4686
[Target-only] Epoch 46/50 – Loss: 0.1799  Val F1: 0.4545  ROC-AUC: 0.7516  PR-AUC: 0.4740
[Target-only] Epoch 47/50 – Loss: 0.1481  Val F1: 0.5116  ROC-AUC: 0.7802  PR-AUC: 0.5521
[Target-only] Epoch 48/50 – Loss: 0.1600  Val F1: 0.5238  ROC-AUC: 0.7769  PR-AUC: 0.5262
[Target-only] Epoch 49/50 – Loss: 0.1632  Val F1: 0.4681  ROC-AUC: 0.7495  PR-AUC: 0.4871
[Target-only] Epoch 50/50 – Loss: 0.1640  Val F1: 0.4762  ROC-AUC: 0.7670  PR-AUC: 0.5386
=== Target-only TEST performance ===
Test F1: 0.5366, ROC-AUC: 0.6978, PR-AUC: 0.4489
✅ 실험 완료: TOX21_ERa_LUC_VM7_Agonist -> NVS_NR_hER [GIN_GAT]
