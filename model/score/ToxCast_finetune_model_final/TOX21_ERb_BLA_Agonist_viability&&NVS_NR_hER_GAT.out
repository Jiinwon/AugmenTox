[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERb_BLA_Agonist_viability_gat.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6728 - Val F1: 0.3333 - Val ROC-AUC: 0.6941 - Val PR-AUC: 0.3749
[Fine-tune] Epoch 2/50 - Loss: 0.6276 - Val F1: 0.3944 - Val ROC-AUC: 0.7664 - Val PR-AUC: 0.4980
[Fine-tune] Epoch 3/50 - Loss: 0.6258 - Val F1: 0.3544 - Val ROC-AUC: 0.7549 - Val PR-AUC: 0.4555
[Fine-tune] Epoch 4/50 - Loss: 0.6019 - Val F1: 0.4225 - Val ROC-AUC: 0.7939 - Val PR-AUC: 0.5349
[Fine-tune] Epoch 5/50 - Loss: 0.5987 - Val F1: 0.4444 - Val ROC-AUC: 0.7884 - Val PR-AUC: 0.5145
[Fine-tune] Epoch 6/50 - Loss: 0.6080 - Val F1: 0.4262 - Val ROC-AUC: 0.7884 - Val PR-AUC: 0.5211
[Fine-tune] Epoch 7/50 - Loss: 0.5897 - Val F1: 0.4062 - Val ROC-AUC: 0.7560 - Val PR-AUC: 0.4867
[Fine-tune] Epoch 8/50 - Loss: 0.5748 - Val F1: 0.4643 - Val ROC-AUC: 0.7807 - Val PR-AUC: 0.5064
[Fine-tune] Epoch 9/50 - Loss: 0.5958 - Val F1: 0.4483 - Val ROC-AUC: 0.7906 - Val PR-AUC: 0.5053
[Fine-tune] Epoch 10/50 - Loss: 0.5713 - Val F1: 0.5098 - Val ROC-AUC: 0.7933 - Val PR-AUC: 0.5287
[Fine-tune] Epoch 11/50 - Loss: 0.6103 - Val F1: 0.4000 - Val ROC-AUC: 0.7900 - Val PR-AUC: 0.5135
[Fine-tune] Epoch 12/50 - Loss: 0.5805 - Val F1: 0.4561 - Val ROC-AUC: 0.7818 - Val PR-AUC: 0.5061
[Fine-tune] Epoch 13/50 - Loss: 0.6141 - Val F1: 0.4727 - Val ROC-AUC: 0.7950 - Val PR-AUC: 0.5164
[Fine-tune] Epoch 14/50 - Loss: 0.6040 - Val F1: 0.5000 - Val ROC-AUC: 0.8010 - Val PR-AUC: 0.5315
[Fine-tune] Epoch 15/50 - Loss: 0.5676 - Val F1: 0.5000 - Val ROC-AUC: 0.7944 - Val PR-AUC: 0.5247
[Fine-tune] Epoch 16/50 - Loss: 0.5861 - Val F1: 0.4561 - Val ROC-AUC: 0.7982 - Val PR-AUC: 0.5258
[Fine-tune] Epoch 17/50 - Loss: 0.5853 - Val F1: 0.4898 - Val ROC-AUC: 0.7993 - Val PR-AUC: 0.5236
[Fine-tune] Epoch 18/50 - Loss: 0.5777 - Val F1: 0.5000 - Val ROC-AUC: 0.7988 - Val PR-AUC: 0.5306
[Fine-tune] Epoch 19/50 - Loss: 0.5749 - Val F1: 0.4898 - Val ROC-AUC: 0.8004 - Val PR-AUC: 0.5346
[Fine-tune] Epoch 20/50 - Loss: 0.5814 - Val F1: 0.5000 - Val ROC-AUC: 0.8130 - Val PR-AUC: 0.5448
[Fine-tune] Epoch 21/50 - Loss: 0.5922 - Val F1: 0.4783 - Val ROC-AUC: 0.8026 - Val PR-AUC: 0.5314
[Fine-tune] Epoch 22/50 - Loss: 0.5800 - Val F1: 0.4444 - Val ROC-AUC: 0.8010 - Val PR-AUC: 0.5296
[Fine-tune] Epoch 23/50 - Loss: 0.5710 - Val F1: 0.5000 - Val ROC-AUC: 0.8059 - Val PR-AUC: 0.5347
[Fine-tune] Epoch 24/50 - Loss: 0.5718 - Val F1: 0.5200 - Val ROC-AUC: 0.8098 - Val PR-AUC: 0.5377
[Fine-tune] Epoch 25/50 - Loss: 0.5901 - Val F1: 0.5098 - Val ROC-AUC: 0.8130 - Val PR-AUC: 0.5462
[Fine-tune] Epoch 26/50 - Loss: 0.5657 - Val F1: 0.5532 - Val ROC-AUC: 0.8114 - Val PR-AUC: 0.5420
[Fine-tune] Epoch 27/50 - Loss: 0.5833 - Val F1: 0.5200 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5472
[Fine-tune] Epoch 28/50 - Loss: 0.5836 - Val F1: 0.5000 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.5401
[Fine-tune] Epoch 29/50 - Loss: 0.5715 - Val F1: 0.5098 - Val ROC-AUC: 0.8158 - Val PR-AUC: 0.5445
[Fine-tune] Epoch 30/50 - Loss: 0.5666 - Val F1: 0.5000 - Val ROC-AUC: 0.8065 - Val PR-AUC: 0.5195
[Fine-tune] Epoch 31/50 - Loss: 0.5893 - Val F1: 0.5000 - Val ROC-AUC: 0.8180 - Val PR-AUC: 0.5402
[Fine-tune] Epoch 32/50 - Loss: 0.5368 - Val F1: 0.5098 - Val ROC-AUC: 0.8109 - Val PR-AUC: 0.5325
[Fine-tune] Epoch 33/50 - Loss: 0.5327 - Val F1: 0.5098 - Val ROC-AUC: 0.8092 - Val PR-AUC: 0.5332
[Fine-tune] Epoch 34/50 - Loss: 0.5436 - Val F1: 0.5098 - Val ROC-AUC: 0.8125 - Val PR-AUC: 0.5383
[Fine-tune] Epoch 35/50 - Loss: 0.5727 - Val F1: 0.5098 - Val ROC-AUC: 0.8120 - Val PR-AUC: 0.5358
[Fine-tune] Epoch 36/50 - Loss: 0.5698 - Val F1: 0.5200 - Val ROC-AUC: 0.8130 - Val PR-AUC: 0.5403
[Fine-tune] Epoch 37/50 - Loss: 0.5560 - Val F1: 0.5306 - Val ROC-AUC: 0.8103 - Val PR-AUC: 0.5389
[Fine-tune] Epoch 38/50 - Loss: 0.5686 - Val F1: 0.5098 - Val ROC-AUC: 0.8076 - Val PR-AUC: 0.5369
[Fine-tune] Epoch 39/50 - Loss: 0.5475 - Val F1: 0.5200 - Val ROC-AUC: 0.8120 - Val PR-AUC: 0.5391
[Fine-tune] Epoch 40/50 - Loss: 0.5625 - Val F1: 0.5306 - Val ROC-AUC: 0.8125 - Val PR-AUC: 0.5399
[Fine-tune] Epoch 41/50 - Loss: 0.5386 - Val F1: 0.5306 - Val ROC-AUC: 0.8136 - Val PR-AUC: 0.5401
[Fine-tune] Epoch 42/50 - Loss: 0.5511 - Val F1: 0.5200 - Val ROC-AUC: 0.8114 - Val PR-AUC: 0.5388
[Fine-tune] Epoch 43/50 - Loss: 0.5700 - Val F1: 0.5306 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.5404
[Fine-tune] Epoch 44/50 - Loss: 0.5788 - Val F1: 0.5200 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5433
[Fine-tune] Epoch 45/50 - Loss: 0.5449 - Val F1: 0.5000 - Val ROC-AUC: 0.8191 - Val PR-AUC: 0.5429
[Fine-tune] Epoch 46/50 - Loss: 0.5396 - Val F1: 0.5098 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5415
[Fine-tune] Epoch 47/50 - Loss: 0.5807 - Val F1: 0.5306 - Val ROC-AUC: 0.8180 - Val PR-AUC: 0.5444
[Fine-tune] Epoch 48/50 - Loss: 0.5416 - Val F1: 0.5306 - Val ROC-AUC: 0.8180 - Val PR-AUC: 0.5460
[Fine-tune] Epoch 49/50 - Loss: 0.5537 - Val F1: 0.5106 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.5506
[Fine-tune] Epoch 50/50 - Loss: 0.5706 - Val F1: 0.5106 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.5477
Finetuning completed. Test F1: 0.4898, ROC-AUC: 0.7477, PR-AUC: 0.5793
[3.1/4] Target-only training on NVS_NR_hER using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_NVS_NR_hER_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.4314, ROC-AUC: 0.7092, PR-AUC: 0.5907
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> NVS_NR_hER [GAT]
