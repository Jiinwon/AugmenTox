[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GCN_GAT...
  * Pretrained model already exists at model_save/pretrained/gcn_gat/Pretrained_TOX21_ERb_BLA_Agonist_viability_gcn_gat.pth, loading...
[3/4] Finetuning on ATG_ERa_TRANS using GCN_GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6127 - Val F1: 0.4751 - Val ROC-AUC: 0.7157 - Val PR-AUC: 0.3823
[Fine-tune] Epoch 2/50 - Loss: 0.5484 - Val F1: 0.4507 - Val ROC-AUC: 0.7367 - Val PR-AUC: 0.4368
[Fine-tune] Epoch 3/50 - Loss: 0.5376 - Val F1: 0.4412 - Val ROC-AUC: 0.7153 - Val PR-AUC: 0.4108
[Fine-tune] Epoch 4/50 - Loss: 0.5351 - Val F1: 0.4975 - Val ROC-AUC: 0.7316 - Val PR-AUC: 0.4360
[Fine-tune] Epoch 5/50 - Loss: 0.5144 - Val F1: 0.4928 - Val ROC-AUC: 0.7403 - Val PR-AUC: 0.4439
[Fine-tune] Epoch 6/50 - Loss: 0.5230 - Val F1: 0.5026 - Val ROC-AUC: 0.7224 - Val PR-AUC: 0.4169
[Fine-tune] Epoch 7/50 - Loss: 0.5031 - Val F1: 0.4494 - Val ROC-AUC: 0.7110 - Val PR-AUC: 0.3996
[Fine-tune] Epoch 8/50 - Loss: 0.5084 - Val F1: 0.5195 - Val ROC-AUC: 0.7446 - Val PR-AUC: 0.4581
[Fine-tune] Epoch 9/50 - Loss: 0.5054 - Val F1: 0.4615 - Val ROC-AUC: 0.7334 - Val PR-AUC: 0.4316
[Fine-tune] Epoch 10/50 - Loss: 0.5004 - Val F1: 0.4783 - Val ROC-AUC: 0.7363 - Val PR-AUC: 0.4244
[Fine-tune] Epoch 11/50 - Loss: 0.4783 - Val F1: 0.4852 - Val ROC-AUC: 0.7341 - Val PR-AUC: 0.4518
[Fine-tune] Epoch 12/50 - Loss: 0.4807 - Val F1: 0.4974 - Val ROC-AUC: 0.7498 - Val PR-AUC: 0.4778
[Fine-tune] Epoch 13/50 - Loss: 0.4585 - Val F1: 0.5087 - Val ROC-AUC: 0.7526 - Val PR-AUC: 0.4753
[Fine-tune] Epoch 14/50 - Loss: 0.4753 - Val F1: 0.5102 - Val ROC-AUC: 0.7489 - Val PR-AUC: 0.4737
[Fine-tune] Epoch 15/50 - Loss: 0.4646 - Val F1: 0.5031 - Val ROC-AUC: 0.7204 - Val PR-AUC: 0.4396
[Fine-tune] Epoch 16/50 - Loss: 0.4587 - Val F1: 0.5132 - Val ROC-AUC: 0.7351 - Val PR-AUC: 0.4489
[Fine-tune] Epoch 17/50 - Loss: 0.4614 - Val F1: 0.4878 - Val ROC-AUC: 0.7396 - Val PR-AUC: 0.4578
[Fine-tune] Epoch 18/50 - Loss: 0.4600 - Val F1: 0.5181 - Val ROC-AUC: 0.7366 - Val PR-AUC: 0.4577
[Fine-tune] Epoch 19/50 - Loss: 0.4605 - Val F1: 0.5200 - Val ROC-AUC: 0.7549 - Val PR-AUC: 0.4938
[Fine-tune] Epoch 20/50 - Loss: 0.4597 - Val F1: 0.5085 - Val ROC-AUC: 0.7439 - Val PR-AUC: 0.4659
[Fine-tune] Epoch 21/50 - Loss: 0.4381 - Val F1: 0.4667 - Val ROC-AUC: 0.7305 - Val PR-AUC: 0.4440
[Fine-tune] Epoch 22/50 - Loss: 0.4407 - Val F1: 0.4948 - Val ROC-AUC: 0.7496 - Val PR-AUC: 0.4589
[Fine-tune] Epoch 23/50 - Loss: 0.4550 - Val F1: 0.4941 - Val ROC-AUC: 0.7505 - Val PR-AUC: 0.4868
[Fine-tune] Epoch 24/50 - Loss: 0.4441 - Val F1: 0.4941 - Val ROC-AUC: 0.7299 - Val PR-AUC: 0.4456
[Fine-tune] Epoch 25/50 - Loss: 0.4315 - Val F1: 0.5153 - Val ROC-AUC: 0.7483 - Val PR-AUC: 0.4801
[Fine-tune] Epoch 26/50 - Loss: 0.4357 - Val F1: 0.4725 - Val ROC-AUC: 0.7408 - Val PR-AUC: 0.4580
[Fine-tune] Epoch 27/50 - Loss: 0.4279 - Val F1: 0.5269 - Val ROC-AUC: 0.7569 - Val PR-AUC: 0.5070
[Fine-tune] Epoch 28/50 - Loss: 0.4129 - Val F1: 0.5062 - Val ROC-AUC: 0.7500 - Val PR-AUC: 0.4860
[Fine-tune] Epoch 29/50 - Loss: 0.4249 - Val F1: 0.5529 - Val ROC-AUC: 0.7451 - Val PR-AUC: 0.4937
[Fine-tune] Epoch 30/50 - Loss: 0.4505 - Val F1: 0.4920 - Val ROC-AUC: 0.7519 - Val PR-AUC: 0.4756
[Fine-tune] Epoch 31/50 - Loss: 0.4298 - Val F1: 0.5181 - Val ROC-AUC: 0.7476 - Val PR-AUC: 0.4994
[Fine-tune] Epoch 32/50 - Loss: 0.4399 - Val F1: 0.4970 - Val ROC-AUC: 0.7440 - Val PR-AUC: 0.4705
[Fine-tune] Epoch 33/50 - Loss: 0.4131 - Val F1: 0.4945 - Val ROC-AUC: 0.7454 - Val PR-AUC: 0.4835
[Fine-tune] Epoch 34/50 - Loss: 0.4299 - Val F1: 0.5000 - Val ROC-AUC: 0.7447 - Val PR-AUC: 0.4786
[Fine-tune] Epoch 35/50 - Loss: 0.4118 - Val F1: 0.4970 - Val ROC-AUC: 0.7476 - Val PR-AUC: 0.4897
[Fine-tune] Epoch 36/50 - Loss: 0.4153 - Val F1: 0.4757 - Val ROC-AUC: 0.7371 - Val PR-AUC: 0.4731
[Fine-tune] Epoch 37/50 - Loss: 0.4238 - Val F1: 0.5122 - Val ROC-AUC: 0.7399 - Val PR-AUC: 0.4702
[Fine-tune] Epoch 38/50 - Loss: 0.4293 - Val F1: 0.5063 - Val ROC-AUC: 0.7423 - Val PR-AUC: 0.4865
[Fine-tune] Epoch 39/50 - Loss: 0.4031 - Val F1: 0.5029 - Val ROC-AUC: 0.7462 - Val PR-AUC: 0.4868
[Fine-tune] Epoch 40/50 - Loss: 0.4246 - Val F1: 0.5263 - Val ROC-AUC: 0.7460 - Val PR-AUC: 0.4827
[Fine-tune] Epoch 41/50 - Loss: 0.4084 - Val F1: 0.5157 - Val ROC-AUC: 0.7503 - Val PR-AUC: 0.4942
[Fine-tune] Epoch 42/50 - Loss: 0.3959 - Val F1: 0.5000 - Val ROC-AUC: 0.7465 - Val PR-AUC: 0.4811
[Fine-tune] Epoch 43/50 - Loss: 0.3983 - Val F1: 0.5091 - Val ROC-AUC: 0.7453 - Val PR-AUC: 0.4858
[Fine-tune] Epoch 44/50 - Loss: 0.4066 - Val F1: 0.4787 - Val ROC-AUC: 0.7432 - Val PR-AUC: 0.4805
[Fine-tune] Epoch 45/50 - Loss: 0.4163 - Val F1: 0.4970 - Val ROC-AUC: 0.7416 - Val PR-AUC: 0.4738
[Fine-tune] Epoch 46/50 - Loss: 0.4274 - Val F1: 0.5385 - Val ROC-AUC: 0.7462 - Val PR-AUC: 0.4876
[Fine-tune] Epoch 47/50 - Loss: 0.4288 - Val F1: 0.5409 - Val ROC-AUC: 0.7339 - Val PR-AUC: 0.4706
[Fine-tune] Epoch 48/50 - Loss: 0.4170 - Val F1: 0.5087 - Val ROC-AUC: 0.7396 - Val PR-AUC: 0.4745
[Fine-tune] Epoch 49/50 - Loss: 0.4033 - Val F1: 0.5085 - Val ROC-AUC: 0.7449 - Val PR-AUC: 0.4853
[Fine-tune] Epoch 50/50 - Loss: 0.3997 - Val F1: 0.4881 - Val ROC-AUC: 0.7379 - Val PR-AUC: 0.4638
Finetuning completed. Test F1: 0.4607, ROC-AUC: 0.7438, PR-AUC: 0.4651
[3.1/4] Target-only training on ATG_ERa_TRANS using GCN_GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gcn_gat/TargetOnly_ATG_ERa_TRANS_gcn_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.4773, ROC-AUC: 0.7580, PR-AUC: 0.4650
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> ATG_ERa_TRANS [GCN_GAT]
