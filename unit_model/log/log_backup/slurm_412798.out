[1/4] Converting Excel to CSV...
[2/4] Pretraining on ERα...
[3/4] Finetuning on ERβ...
[4/4] Visualizing embeddings...
Epoch 1/50 - Loss: 0.6451 - Val F1: 0.3156 - Val ROC-AUC: 0.6869 - Val PR-AUC: 0.2207
Epoch 2/50 - Loss: 0.5930 - Val F1: 0.3566 - Val ROC-AUC: 0.7252 - Val PR-AUC: 0.2603
Epoch 3/50 - Loss: 0.5784 - Val F1: 0.3636 - Val ROC-AUC: 0.7371 - Val PR-AUC: 0.2799
Epoch 4/50 - Loss: 0.5645 - Val F1: 0.3297 - Val ROC-AUC: 0.7302 - Val PR-AUC: 0.2541
Epoch 5/50 - Loss: 0.5586 - Val F1: 0.3488 - Val ROC-AUC: 0.7499 - Val PR-AUC: 0.2769
Epoch 6/50 - Loss: 0.5377 - Val F1: 0.3556 - Val ROC-AUC: 0.7581 - Val PR-AUC: 0.2692
Epoch 7/50 - Loss: 0.5287 - Val F1: 0.3594 - Val ROC-AUC: 0.7677 - Val PR-AUC: 0.3069
Epoch 8/50 - Loss: 0.5201 - Val F1: 0.3478 - Val ROC-AUC: 0.7725 - Val PR-AUC: 0.3197
Epoch 9/50 - Loss: 0.5023 - Val F1: 0.3650 - Val ROC-AUC: 0.7582 - Val PR-AUC: 0.2937
Epoch 10/50 - Loss: 0.5013 - Val F1: 0.3812 - Val ROC-AUC: 0.7744 - Val PR-AUC: 0.3057
Epoch 11/50 - Loss: 0.4942 - Val F1: 0.4155 - Val ROC-AUC: 0.7981 - Val PR-AUC: 0.3238
Epoch 12/50 - Loss: 0.4724 - Val F1: 0.4056 - Val ROC-AUC: 0.7934 - Val PR-AUC: 0.3251
Epoch 13/50 - Loss: 0.4622 - Val F1: 0.3980 - Val ROC-AUC: 0.7897 - Val PR-AUC: 0.3113
Epoch 14/50 - Loss: 0.4667 - Val F1: 0.4031 - Val ROC-AUC: 0.7955 - Val PR-AUC: 0.3295
Epoch 15/50 - Loss: 0.4558 - Val F1: 0.3947 - Val ROC-AUC: 0.7901 - Val PR-AUC: 0.3257
Epoch 16/50 - Loss: 0.4503 - Val F1: 0.4048 - Val ROC-AUC: 0.7951 - Val PR-AUC: 0.3114
Epoch 17/50 - Loss: 0.4489 - Val F1: 0.3842 - Val ROC-AUC: 0.7904 - Val PR-AUC: 0.3345
Epoch 18/50 - Loss: 0.4469 - Val F1: 0.4092 - Val ROC-AUC: 0.7945 - Val PR-AUC: 0.3404
Epoch 19/50 - Loss: 0.4382 - Val F1: 0.3777 - Val ROC-AUC: 0.7835 - Val PR-AUC: 0.3252
Epoch 20/50 - Loss: 0.4424 - Val F1: 0.3949 - Val ROC-AUC: 0.7903 - Val PR-AUC: 0.3187
Epoch 21/50 - Loss: 0.4276 - Val F1: 0.4022 - Val ROC-AUC: 0.8077 - Val PR-AUC: 0.3572
Epoch 22/50 - Loss: 0.4090 - Val F1: 0.3848 - Val ROC-AUC: 0.7986 - Val PR-AUC: 0.3600
Epoch 23/50 - Loss: 0.4044 - Val F1: 0.4459 - Val ROC-AUC: 0.8044 - Val PR-AUC: 0.3558
Epoch 24/50 - Loss: 0.4108 - Val F1: 0.4109 - Val ROC-AUC: 0.7889 - Val PR-AUC: 0.3441
Epoch 25/50 - Loss: 0.3922 - Val F1: 0.4160 - Val ROC-AUC: 0.8049 - Val PR-AUC: 0.3552
Epoch 26/50 - Loss: 0.3912 - Val F1: 0.4298 - Val ROC-AUC: 0.8156 - Val PR-AUC: 0.3579
Epoch 27/50 - Loss: 0.3922 - Val F1: 0.4213 - Val ROC-AUC: 0.8042 - Val PR-AUC: 0.3478
Epoch 28/50 - Loss: 0.4098 - Val F1: 0.4164 - Val ROC-AUC: 0.8070 - Val PR-AUC: 0.3457
Epoch 29/50 - Loss: 0.3855 - Val F1: 0.4091 - Val ROC-AUC: 0.8059 - Val PR-AUC: 0.3529
Epoch 30/50 - Loss: 0.3863 - Val F1: 0.4202 - Val ROC-AUC: 0.8029 - Val PR-AUC: 0.3509
Epoch 31/50 - Loss: 0.3775 - Val F1: 0.4277 - Val ROC-AUC: 0.8057 - Val PR-AUC: 0.3649
Epoch 32/50 - Loss: 0.3692 - Val F1: 0.4260 - Val ROC-AUC: 0.8091 - Val PR-AUC: 0.3842
Epoch 33/50 - Loss: 0.3561 - Val F1: 0.4220 - Val ROC-AUC: 0.8138 - Val PR-AUC: 0.3804
Epoch 34/50 - Loss: 0.3606 - Val F1: 0.4360 - Val ROC-AUC: 0.8122 - Val PR-AUC: 0.3645
Epoch 35/50 - Loss: 0.3687 - Val F1: 0.4207 - Val ROC-AUC: 0.8136 - Val PR-AUC: 0.3657
Epoch 36/50 - Loss: 0.3632 - Val F1: 0.4343 - Val ROC-AUC: 0.8136 - Val PR-AUC: 0.3723
Epoch 37/50 - Loss: 0.3662 - Val F1: 0.4479 - Val ROC-AUC: 0.8212 - Val PR-AUC: 0.3852
Epoch 38/50 - Loss: 0.3504 - Val F1: 0.4241 - Val ROC-AUC: 0.8111 - Val PR-AUC: 0.3628
Epoch 39/50 - Loss: 0.3512 - Val F1: 0.4183 - Val ROC-AUC: 0.8091 - Val PR-AUC: 0.3674
Epoch 40/50 - Loss: 0.3415 - Val F1: 0.4307 - Val ROC-AUC: 0.8107 - Val PR-AUC: 0.3661
Epoch 41/50 - Loss: 0.3578 - Val F1: 0.4416 - Val ROC-AUC: 0.8151 - Val PR-AUC: 0.3734
Epoch 42/50 - Loss: 0.3461 - Val F1: 0.4320 - Val ROC-AUC: 0.8166 - Val PR-AUC: 0.3789
Epoch 43/50 - Loss: 0.3345 - Val F1: 0.4179 - Val ROC-AUC: 0.8092 - Val PR-AUC: 0.3664
Epoch 44/50 - Loss: 0.3302 - Val F1: 0.4268 - Val ROC-AUC: 0.8090 - Val PR-AUC: 0.3631
Epoch 45/50 - Loss: 0.3381 - Val F1: 0.4343 - Val ROC-AUC: 0.8137 - Val PR-AUC: 0.3715
Epoch 46/50 - Loss: 0.3410 - Val F1: 0.4557 - Val ROC-AUC: 0.8165 - Val PR-AUC: 0.3758
Epoch 47/50 - Loss: 0.3336 - Val F1: 0.4329 - Val ROC-AUC: 0.8118 - Val PR-AUC: 0.3652
Epoch 48/50 - Loss: 0.3287 - Val F1: 0.4353 - Val ROC-AUC: 0.8159 - Val PR-AUC: 0.3610
Epoch 49/50 - Loss: 0.3377 - Val F1: 0.4384 - Val ROC-AUC: 0.8120 - Val PR-AUC: 0.3612
Epoch 50/50 - Loss: 0.3350 - Val F1: 0.4340 - Val ROC-AUC: 0.8058 - Val PR-AUC: 0.3523
Pretraining completed. Test F1: 0.4161, ROC-AUC: 0.7957, PR-AUC: 0.4037
[Fine-tune] Epoch 1/50 - Loss: 0.5348 - Val F1: 0.4169 - Val ROC-AUC: 0.7969 - Val PR-AUC: 0.3833
[Fine-tune] Epoch 2/50 - Loss: 0.4888 - Val F1: 0.3978 - Val ROC-AUC: 0.8050 - Val PR-AUC: 0.4182
[Fine-tune] Epoch 3/50 - Loss: 0.4770 - Val F1: 0.4239 - Val ROC-AUC: 0.8064 - Val PR-AUC: 0.4030
[Fine-tune] Epoch 4/50 - Loss: 0.4793 - Val F1: 0.4265 - Val ROC-AUC: 0.8057 - Val PR-AUC: 0.3657
[Fine-tune] Epoch 5/50 - Loss: 0.4622 - Val F1: 0.4037 - Val ROC-AUC: 0.8114 - Val PR-AUC: 0.4018
[Fine-tune] Epoch 6/50 - Loss: 0.4551 - Val F1: 0.4340 - Val ROC-AUC: 0.8132 - Val PR-AUC: 0.3711
[Fine-tune] Epoch 7/50 - Loss: 0.4418 - Val F1: 0.3944 - Val ROC-AUC: 0.7894 - Val PR-AUC: 0.3533
[Fine-tune] Epoch 8/50 - Loss: 0.4420 - Val F1: 0.4262 - Val ROC-AUC: 0.8159 - Val PR-AUC: 0.3566
[Fine-tune] Epoch 9/50 - Loss: 0.4350 - Val F1: 0.3812 - Val ROC-AUC: 0.7843 - Val PR-AUC: 0.3525
[Fine-tune] Epoch 10/50 - Loss: 0.4182 - Val F1: 0.4116 - Val ROC-AUC: 0.7995 - Val PR-AUC: 0.3825
[Fine-tune] Epoch 11/50 - Loss: 0.4098 - Val F1: 0.4218 - Val ROC-AUC: 0.8053 - Val PR-AUC: 0.4017
[Fine-tune] Epoch 12/50 - Loss: 0.3939 - Val F1: 0.4431 - Val ROC-AUC: 0.8262 - Val PR-AUC: 0.4161
[Fine-tune] Epoch 13/50 - Loss: 0.3779 - Val F1: 0.4051 - Val ROC-AUC: 0.8206 - Val PR-AUC: 0.4006
[Fine-tune] Epoch 14/50 - Loss: 0.3678 - Val F1: 0.4382 - Val ROC-AUC: 0.8160 - Val PR-AUC: 0.4005
[Fine-tune] Epoch 15/50 - Loss: 0.3611 - Val F1: 0.4323 - Val ROC-AUC: 0.8225 - Val PR-AUC: 0.4084
[Fine-tune] Epoch 16/50 - Loss: 0.3625 - Val F1: 0.4167 - Val ROC-AUC: 0.8104 - Val PR-AUC: 0.3904
[Fine-tune] Epoch 17/50 - Loss: 0.3623 - Val F1: 0.4214 - Val ROC-AUC: 0.8214 - Val PR-AUC: 0.4298
[Fine-tune] Epoch 18/50 - Loss: 0.3599 - Val F1: 0.4252 - Val ROC-AUC: 0.8120 - Val PR-AUC: 0.3951
[Fine-tune] Epoch 19/50 - Loss: 0.3350 - Val F1: 0.4195 - Val ROC-AUC: 0.8081 - Val PR-AUC: 0.4043
[Fine-tune] Epoch 20/50 - Loss: 0.3485 - Val F1: 0.4254 - Val ROC-AUC: 0.8175 - Val PR-AUC: 0.4074
[Fine-tune] Epoch 21/50 - Loss: 0.3352 - Val F1: 0.4250 - Val ROC-AUC: 0.8199 - Val PR-AUC: 0.4026
[Fine-tune] Epoch 22/50 - Loss: 0.3083 - Val F1: 0.4475 - Val ROC-AUC: 0.8291 - Val PR-AUC: 0.4328
[Fine-tune] Epoch 23/50 - Loss: 0.3160 - Val F1: 0.4483 - Val ROC-AUC: 0.8167 - Val PR-AUC: 0.4123
[Fine-tune] Epoch 24/50 - Loss: 0.2928 - Val F1: 0.4354 - Val ROC-AUC: 0.8214 - Val PR-AUC: 0.4294
[Fine-tune] Epoch 25/50 - Loss: 0.3115 - Val F1: 0.4610 - Val ROC-AUC: 0.8199 - Val PR-AUC: 0.4299
[Fine-tune] Epoch 26/50 - Loss: 0.2935 - Val F1: 0.4330 - Val ROC-AUC: 0.8054 - Val PR-AUC: 0.3961
[Fine-tune] Epoch 27/50 - Loss: 0.2944 - Val F1: 0.4473 - Val ROC-AUC: 0.8167 - Val PR-AUC: 0.4183
[Fine-tune] Epoch 28/50 - Loss: 0.2979 - Val F1: 0.4436 - Val ROC-AUC: 0.8138 - Val PR-AUC: 0.4132
[Fine-tune] Epoch 29/50 - Loss: 0.3006 - Val F1: 0.4582 - Val ROC-AUC: 0.8098 - Val PR-AUC: 0.4023
[Fine-tune] Epoch 30/50 - Loss: 0.2905 - Val F1: 0.4407 - Val ROC-AUC: 0.8084 - Val PR-AUC: 0.3823
[Fine-tune] Epoch 31/50 - Loss: 0.2811 - Val F1: 0.4460 - Val ROC-AUC: 0.8115 - Val PR-AUC: 0.4046
[Fine-tune] Epoch 32/50 - Loss: 0.2700 - Val F1: 0.4460 - Val ROC-AUC: 0.8140 - Val PR-AUC: 0.3927
[Fine-tune] Epoch 33/50 - Loss: 0.2744 - Val F1: 0.4498 - Val ROC-AUC: 0.8080 - Val PR-AUC: 0.3779
[Fine-tune] Epoch 34/50 - Loss: 0.2664 - Val F1: 0.4377 - Val ROC-AUC: 0.8112 - Val PR-AUC: 0.3890
[Fine-tune] Epoch 35/50 - Loss: 0.2672 - Val F1: 0.4460 - Val ROC-AUC: 0.8058 - Val PR-AUC: 0.3949
[Fine-tune] Epoch 36/50 - Loss: 0.2747 - Val F1: 0.4516 - Val ROC-AUC: 0.8113 - Val PR-AUC: 0.4027
[Fine-tune] Epoch 37/50 - Loss: 0.2558 - Val F1: 0.4406 - Val ROC-AUC: 0.8100 - Val PR-AUC: 0.3964
[Fine-tune] Epoch 38/50 - Loss: 0.2706 - Val F1: 0.4503 - Val ROC-AUC: 0.8134 - Val PR-AUC: 0.4045
[Fine-tune] Epoch 39/50 - Loss: 0.2583 - Val F1: 0.4467 - Val ROC-AUC: 0.8146 - Val PR-AUC: 0.3964
[Fine-tune] Epoch 40/50 - Loss: 0.2618 - Val F1: 0.4332 - Val ROC-AUC: 0.8112 - Val PR-AUC: 0.3997
[Fine-tune] Epoch 41/50 - Loss: 0.2573 - Val F1: 0.4535 - Val ROC-AUC: 0.8146 - Val PR-AUC: 0.4185
[Fine-tune] Epoch 42/50 - Loss: 0.2476 - Val F1: 0.4494 - Val ROC-AUC: 0.8091 - Val PR-AUC: 0.4062
[Fine-tune] Epoch 43/50 - Loss: 0.2445 - Val F1: 0.4469 - Val ROC-AUC: 0.8054 - Val PR-AUC: 0.4035
[Fine-tune] Epoch 44/50 - Loss: 0.2568 - Val F1: 0.4354 - Val ROC-AUC: 0.8083 - Val PR-AUC: 0.4131
[Fine-tune] Epoch 45/50 - Loss: 0.2415 - Val F1: 0.4437 - Val ROC-AUC: 0.8099 - Val PR-AUC: 0.4087
[Fine-tune] Epoch 46/50 - Loss: 0.2437 - Val F1: 0.4542 - Val ROC-AUC: 0.8062 - Val PR-AUC: 0.4021
[Fine-tune] Epoch 47/50 - Loss: 0.2478 - Val F1: 0.4504 - Val ROC-AUC: 0.8074 - Val PR-AUC: 0.3994
[Fine-tune] Epoch 48/50 - Loss: 0.2427 - Val F1: 0.4610 - Val ROC-AUC: 0.8111 - Val PR-AUC: 0.4114
[Fine-tune] Epoch 49/50 - Loss: 0.2521 - Val F1: 0.4773 - Val ROC-AUC: 0.8113 - Val PR-AUC: 0.4118
[Fine-tune] Epoch 50/50 - Loss: 0.2314 - Val F1: 0.4437 - Val ROC-AUC: 0.8111 - Val PR-AUC: 0.4043
Finetuning completed. Test F1: 0.5020, ROC-AUC: 0.8261, PR-AUC: 0.4542
