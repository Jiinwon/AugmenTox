[1/4] Converting Excel to CSV...
[2/4] Pre-training on ERα...
[3/4] Fine-tuning on ERβ...
[4/4] Visualizing embeddings...
[12:51:18] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[12:51:18] Explicit valence for atom # 0 Cl, 2, is greater than permitted
[12:51:19] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[12:51:20] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[12:51:20] WARNING: not removing hydrogen atom without neighbors
[12:51:22] Explicit valence for atom # 3 Si, 8, is greater than permitted
[12:51:22] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[12:51:22] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[12:51:23] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[12:51:23] WARNING: not removing hydrogen atom without neighbors
[12:51:24] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[12:51:24] Explicit valence for atom # 6 O, 3, is greater than permitted
[12:51:24] Explicit valence for atom # 3 Si, 8, is greater than permitted
[12:51:24] Explicit valence for atom # 0 Cl, 2, is greater than permitted
Epoch 1/2 - Loss: 0.3778 - Val F1: 0.0000 - Val ROC-AUC: 0.6448 - Val PR-AUC: 0.1835
Epoch 2/2 - Loss: 0.3553 - Val F1: 0.0000 - Val ROC-AUC: 0.6915 - Val PR-AUC: 0.2238
Pretraining completed. Test F1: 0.0185, ROC-AUC: 0.7247, PR-AUC: 0.2526
[13:00:36] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:00:36] Explicit valence for atom # 0 Cl, 2, is greater than permitted
[13:00:37] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[13:00:37] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[13:00:40] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:00:40] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[13:00:40] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:00:40] WARNING: not removing hydrogen atom without neighbors
[13:00:41] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:00:41] Explicit valence for atom # 6 O, 3, is greater than permitted
[13:00:41] Explicit valence for atom # 3 Si, 8, is greater than permitted
[13:00:41] Explicit valence for atom # 0 Cl, 2, is greater than permitted
[Fine-tune] Epoch 1/2 - Loss: 0.3570 - Val F1: 0.0000 - Val ROC-AUC: 0.7336 - Val PR-AUC: 0.2664
[Fine-tune] Epoch 2/2 - Loss: 0.3452 - Val F1: 0.0000 - Val ROC-AUC: 0.7489 - Val PR-AUC: 0.2907
Finetuning completed. Test F1: 0.0392, ROC-AUC: 0.7574, PR-AUC: 0.3108
[13:09:25] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:09:26] Explicit valence for atom # 0 Cl, 2, is greater than permitted
[13:09:26] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[13:09:27] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[13:09:29] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:09:29] Can't kekulize mol.  Unkekulized atoms: 3 4 5 6 7
[13:09:30] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:09:30] WARNING: not removing hydrogen atom without neighbors
[13:09:30] Can't kekulize mol.  Unkekulized atoms: 1 2 3 4 5
[13:09:30] Explicit valence for atom # 6 O, 3, is greater than permitted
[13:09:30] Explicit valence for atom # 3 Si, 8, is greater than permitted
[13:09:31] Explicit valence for atom # 0 Cl, 2, is greater than permitted
Traceback (most recent call last):
  File "<stdin>", line 24, in <module>
  File "/gpfs/home1/won0316/_Capstone/1_Git/Capstone_uos/unit_model/data/load_data.py", line 32, in load_data
    train_data, temp_data, train_labels, temp_labels = train_test_split(
                                                       ^^^^^^^^^^^^^^^^^
  File "/home1/won0316/anaconda3/envs/toxcast_env/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home1/won0316/anaconda3/envs/toxcast_env/lib/python3.12/site-packages/sklearn/model_selection/_split.py", line 2806, in train_test_split
    train, test = next(cv.split(X=arrays[0], y=stratify))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/won0316/anaconda3/envs/toxcast_env/lib/python3.12/site-packages/sklearn/model_selection/_split.py", line 1843, in split
    for train, test in self._iter_indices(X, y, groups):
  File "/home1/won0316/anaconda3/envs/toxcast_env/lib/python3.12/site-packages/sklearn/model_selection/_split.py", line 2265, in _iter_indices
    raise ValueError(
ValueError: The test_size = 1 should be greater or equal to the number of classes = 2
