[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability_gat.pth, loading...
[3/4] Finetuning on OT_ER_ERaERa_1440 using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6243 - Val F1: 0.2069 - Val ROC-AUC: 0.6677 - Val PR-AUC: 0.3681
[Fine-tune] Epoch 2/50 - Loss: 0.5872 - Val F1: 0.2800 - Val ROC-AUC: 0.6517 - Val PR-AUC: 0.3742
[Fine-tune] Epoch 3/50 - Loss: 0.5850 - Val F1: 0.2286 - Val ROC-AUC: 0.6498 - Val PR-AUC: 0.3666
[Fine-tune] Epoch 4/50 - Loss: 0.5643 - Val F1: 0.2667 - Val ROC-AUC: 0.6696 - Val PR-AUC: 0.3287
[Fine-tune] Epoch 5/50 - Loss: 0.5811 - Val F1: 0.2192 - Val ROC-AUC: 0.6273 - Val PR-AUC: 0.3529
[Fine-tune] Epoch 6/50 - Loss: 0.5746 - Val F1: 0.2333 - Val ROC-AUC: 0.6319 - Val PR-AUC: 0.3545
[Fine-tune] Epoch 7/50 - Loss: 0.5614 - Val F1: 0.2424 - Val ROC-AUC: 0.6075 - Val PR-AUC: 0.3169
[Fine-tune] Epoch 8/50 - Loss: 0.5481 - Val F1: 0.2500 - Val ROC-AUC: 0.6330 - Val PR-AUC: 0.3686
[Fine-tune] Epoch 9/50 - Loss: 0.5291 - Val F1: 0.2333 - Val ROC-AUC: 0.6551 - Val PR-AUC: 0.3378
[Fine-tune] Epoch 10/50 - Loss: 0.5718 - Val F1: 0.2319 - Val ROC-AUC: 0.6532 - Val PR-AUC: 0.3721
[Fine-tune] Epoch 11/50 - Loss: 0.5496 - Val F1: 0.2759 - Val ROC-AUC: 0.6456 - Val PR-AUC: 0.3600
[Fine-tune] Epoch 12/50 - Loss: 0.5554 - Val F1: 0.2333 - Val ROC-AUC: 0.6425 - Val PR-AUC: 0.3719
[Fine-tune] Epoch 13/50 - Loss: 0.5238 - Val F1: 0.2456 - Val ROC-AUC: 0.6441 - Val PR-AUC: 0.3357
[Fine-tune] Epoch 14/50 - Loss: 0.5223 - Val F1: 0.2222 - Val ROC-AUC: 0.6376 - Val PR-AUC: 0.3647
[Fine-tune] Epoch 15/50 - Loss: 0.5295 - Val F1: 0.2581 - Val ROC-AUC: 0.6559 - Val PR-AUC: 0.3539
[Fine-tune] Epoch 16/50 - Loss: 0.5446 - Val F1: 0.2353 - Val ROC-AUC: 0.6395 - Val PR-AUC: 0.3720
[Fine-tune] Epoch 17/50 - Loss: 0.5257 - Val F1: 0.2807 - Val ROC-AUC: 0.6562 - Val PR-AUC: 0.3428
[Fine-tune] Epoch 18/50 - Loss: 0.5454 - Val F1: 0.2319 - Val ROC-AUC: 0.6502 - Val PR-AUC: 0.3990
[Fine-tune] Epoch 19/50 - Loss: 0.5339 - Val F1: 0.2963 - Val ROC-AUC: 0.6361 - Val PR-AUC: 0.3767
[Fine-tune] Epoch 20/50 - Loss: 0.5119 - Val F1: 0.2500 - Val ROC-AUC: 0.6479 - Val PR-AUC: 0.3499
[Fine-tune] Epoch 21/50 - Loss: 0.5281 - Val F1: 0.2414 - Val ROC-AUC: 0.6399 - Val PR-AUC: 0.3375
[Fine-tune] Epoch 22/50 - Loss: 0.5208 - Val F1: 0.2692 - Val ROC-AUC: 0.6300 - Val PR-AUC: 0.3444
[Fine-tune] Epoch 23/50 - Loss: 0.5378 - Val F1: 0.2623 - Val ROC-AUC: 0.6399 - Val PR-AUC: 0.3624
[Fine-tune] Epoch 24/50 - Loss: 0.5429 - Val F1: 0.2745 - Val ROC-AUC: 0.6326 - Val PR-AUC: 0.3526
[Fine-tune] Epoch 25/50 - Loss: 0.5131 - Val F1: 0.2857 - Val ROC-AUC: 0.6566 - Val PR-AUC: 0.3645
[Fine-tune] Epoch 26/50 - Loss: 0.5013 - Val F1: 0.2692 - Val ROC-AUC: 0.6364 - Val PR-AUC: 0.3617
[Fine-tune] Epoch 27/50 - Loss: 0.5336 - Val F1: 0.2692 - Val ROC-AUC: 0.6311 - Val PR-AUC: 0.3671
[Fine-tune] Epoch 28/50 - Loss: 0.5141 - Val F1: 0.2667 - Val ROC-AUC: 0.6197 - Val PR-AUC: 0.3609
[Fine-tune] Epoch 29/50 - Loss: 0.5004 - Val F1: 0.2623 - Val ROC-AUC: 0.6402 - Val PR-AUC: 0.3522
[Fine-tune] Epoch 30/50 - Loss: 0.5160 - Val F1: 0.2712 - Val ROC-AUC: 0.6414 - Val PR-AUC: 0.2812
[Fine-tune] Epoch 31/50 - Loss: 0.4987 - Val F1: 0.2857 - Val ROC-AUC: 0.6482 - Val PR-AUC: 0.3341
[Fine-tune] Epoch 32/50 - Loss: 0.5287 - Val F1: 0.2759 - Val ROC-AUC: 0.6509 - Val PR-AUC: 0.2994
[Fine-tune] Epoch 33/50 - Loss: 0.5321 - Val F1: 0.2909 - Val ROC-AUC: 0.6441 - Val PR-AUC: 0.3262
[Fine-tune] Epoch 34/50 - Loss: 0.5006 - Val F1: 0.2712 - Val ROC-AUC: 0.6437 - Val PR-AUC: 0.3477
[Fine-tune] Epoch 35/50 - Loss: 0.5216 - Val F1: 0.2500 - Val ROC-AUC: 0.6452 - Val PR-AUC: 0.3637
[Fine-tune] Epoch 36/50 - Loss: 0.4995 - Val F1: 0.2500 - Val ROC-AUC: 0.6482 - Val PR-AUC: 0.3563
[Fine-tune] Epoch 37/50 - Loss: 0.5156 - Val F1: 0.2414 - Val ROC-AUC: 0.6380 - Val PR-AUC: 0.3436
[Fine-tune] Epoch 38/50 - Loss: 0.4972 - Val F1: 0.2593 - Val ROC-AUC: 0.6368 - Val PR-AUC: 0.3155
[Fine-tune] Epoch 39/50 - Loss: 0.5086 - Val F1: 0.2500 - Val ROC-AUC: 0.6433 - Val PR-AUC: 0.3120
[Fine-tune] Epoch 40/50 - Loss: 0.4900 - Val F1: 0.2759 - Val ROC-AUC: 0.6471 - Val PR-AUC: 0.3180
[Fine-tune] Epoch 41/50 - Loss: 0.4869 - Val F1: 0.2759 - Val ROC-AUC: 0.6406 - Val PR-AUC: 0.3231
[Fine-tune] Epoch 42/50 - Loss: 0.4924 - Val F1: 0.2593 - Val ROC-AUC: 0.6444 - Val PR-AUC: 0.3258
[Fine-tune] Epoch 43/50 - Loss: 0.5017 - Val F1: 0.2979 - Val ROC-AUC: 0.6414 - Val PR-AUC: 0.3392
[Fine-tune] Epoch 44/50 - Loss: 0.4881 - Val F1: 0.2593 - Val ROC-AUC: 0.6387 - Val PR-AUC: 0.2896
[Fine-tune] Epoch 45/50 - Loss: 0.5158 - Val F1: 0.2500 - Val ROC-AUC: 0.6372 - Val PR-AUC: 0.2939
[Fine-tune] Epoch 46/50 - Loss: 0.5221 - Val F1: 0.2545 - Val ROC-AUC: 0.6380 - Val PR-AUC: 0.3455
[Fine-tune] Epoch 47/50 - Loss: 0.4763 - Val F1: 0.2414 - Val ROC-AUC: 0.6414 - Val PR-AUC: 0.3460
[Fine-tune] Epoch 48/50 - Loss: 0.5096 - Val F1: 0.2642 - Val ROC-AUC: 0.6357 - Val PR-AUC: 0.3261
[Fine-tune] Epoch 49/50 - Loss: 0.5101 - Val F1: 0.2500 - Val ROC-AUC: 0.6345 - Val PR-AUC: 0.3195
[Fine-tune] Epoch 50/50 - Loss: 0.5049 - Val F1: 0.2456 - Val ROC-AUC: 0.6368 - Val PR-AUC: 0.3217
Finetuning completed. Test F1: 0.2692, ROC-AUC: 0.7927, PR-AUC: 0.3332
[3.1/4] Target-only training on OT_ER_ERaERa_1440 using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_OT_ER_ERaERa_1440_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.3077, ROC-AUC: 0.7685, PR-AUC: 0.1781
✅ 실험 완료: TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability -> OT_ER_ERaERa_1440 [GAT]
