[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability_gat.pth, loading...
[3/4] Finetuning on OT_ER_ERaERb_1440 using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6564 - Val F1: 0.3368 - Val ROC-AUC: 0.6689 - Val PR-AUC: 0.3830
[Fine-tune] Epoch 2/50 - Loss: 0.6146 - Val F1: 0.3529 - Val ROC-AUC: 0.6546 - Val PR-AUC: 0.3743
[Fine-tune] Epoch 3/50 - Loss: 0.5817 - Val F1: 0.3333 - Val ROC-AUC: 0.6678 - Val PR-AUC: 0.3992
[Fine-tune] Epoch 4/50 - Loss: 0.5826 - Val F1: 0.4407 - Val ROC-AUC: 0.6779 - Val PR-AUC: 0.3962
[Fine-tune] Epoch 5/50 - Loss: 0.5806 - Val F1: 0.3846 - Val ROC-AUC: 0.6741 - Val PR-AUC: 0.4018
[Fine-tune] Epoch 6/50 - Loss: 0.5832 - Val F1: 0.4324 - Val ROC-AUC: 0.6762 - Val PR-AUC: 0.4040
[Fine-tune] Epoch 7/50 - Loss: 0.5675 - Val F1: 0.3611 - Val ROC-AUC: 0.6718 - Val PR-AUC: 0.3928
[Fine-tune] Epoch 8/50 - Loss: 0.5600 - Val F1: 0.3448 - Val ROC-AUC: 0.6734 - Val PR-AUC: 0.4218
[Fine-tune] Epoch 9/50 - Loss: 0.6099 - Val F1: 0.3542 - Val ROC-AUC: 0.6741 - Val PR-AUC: 0.4274
[Fine-tune] Epoch 10/50 - Loss: 0.5893 - Val F1: 0.3951 - Val ROC-AUC: 0.6854 - Val PR-AUC: 0.4311
[Fine-tune] Epoch 11/50 - Loss: 0.5613 - Val F1: 0.4478 - Val ROC-AUC: 0.6974 - Val PR-AUC: 0.4042
[Fine-tune] Epoch 12/50 - Loss: 0.5883 - Val F1: 0.4348 - Val ROC-AUC: 0.6873 - Val PR-AUC: 0.3971
[Fine-tune] Epoch 13/50 - Loss: 0.5772 - Val F1: 0.4051 - Val ROC-AUC: 0.6870 - Val PR-AUC: 0.4151
[Fine-tune] Epoch 14/50 - Loss: 0.5905 - Val F1: 0.4000 - Val ROC-AUC: 0.6809 - Val PR-AUC: 0.3908
[Fine-tune] Epoch 15/50 - Loss: 0.5861 - Val F1: 0.3896 - Val ROC-AUC: 0.6732 - Val PR-AUC: 0.3866
[Fine-tune] Epoch 16/50 - Loss: 0.5569 - Val F1: 0.4167 - Val ROC-AUC: 0.6870 - Val PR-AUC: 0.3853
[Fine-tune] Epoch 17/50 - Loss: 0.5579 - Val F1: 0.4110 - Val ROC-AUC: 0.6910 - Val PR-AUC: 0.3923
[Fine-tune] Epoch 18/50 - Loss: 0.5573 - Val F1: 0.3947 - Val ROC-AUC: 0.6842 - Val PR-AUC: 0.4081
[Fine-tune] Epoch 19/50 - Loss: 0.5751 - Val F1: 0.3733 - Val ROC-AUC: 0.6790 - Val PR-AUC: 0.4260
[Fine-tune] Epoch 20/50 - Loss: 0.5806 - Val F1: 0.3784 - Val ROC-AUC: 0.6790 - Val PR-AUC: 0.3794
[Fine-tune] Epoch 21/50 - Loss: 0.5686 - Val F1: 0.3896 - Val ROC-AUC: 0.6807 - Val PR-AUC: 0.3956
[Fine-tune] Epoch 22/50 - Loss: 0.5559 - Val F1: 0.4118 - Val ROC-AUC: 0.6898 - Val PR-AUC: 0.4233
[Fine-tune] Epoch 23/50 - Loss: 0.5616 - Val F1: 0.4062 - Val ROC-AUC: 0.6896 - Val PR-AUC: 0.3872
[Fine-tune] Epoch 24/50 - Loss: 0.5598 - Val F1: 0.3836 - Val ROC-AUC: 0.6891 - Val PR-AUC: 0.3895
[Fine-tune] Epoch 25/50 - Loss: 0.5290 - Val F1: 0.3784 - Val ROC-AUC: 0.6866 - Val PR-AUC: 0.3862
[Fine-tune] Epoch 26/50 - Loss: 0.5629 - Val F1: 0.3944 - Val ROC-AUC: 0.6908 - Val PR-AUC: 0.3872
[Fine-tune] Epoch 27/50 - Loss: 0.5475 - Val F1: 0.4058 - Val ROC-AUC: 0.6927 - Val PR-AUC: 0.3862
[Fine-tune] Epoch 28/50 - Loss: 0.5501 - Val F1: 0.4348 - Val ROC-AUC: 0.6995 - Val PR-AUC: 0.3999
[Fine-tune] Epoch 29/50 - Loss: 0.5503 - Val F1: 0.4110 - Val ROC-AUC: 0.6974 - Val PR-AUC: 0.3878
[Fine-tune] Epoch 30/50 - Loss: 0.5405 - Val F1: 0.3611 - Val ROC-AUC: 0.6880 - Val PR-AUC: 0.3811
[Fine-tune] Epoch 31/50 - Loss: 0.5520 - Val F1: 0.4000 - Val ROC-AUC: 0.6927 - Val PR-AUC: 0.3777
[Fine-tune] Epoch 32/50 - Loss: 0.5723 - Val F1: 0.4058 - Val ROC-AUC: 0.6995 - Val PR-AUC: 0.3864
[Fine-tune] Epoch 33/50 - Loss: 0.5537 - Val F1: 0.4167 - Val ROC-AUC: 0.6964 - Val PR-AUC: 0.3989
[Fine-tune] Epoch 34/50 - Loss: 0.5590 - Val F1: 0.4375 - Val ROC-AUC: 0.6960 - Val PR-AUC: 0.3926
[Fine-tune] Epoch 35/50 - Loss: 0.5431 - Val F1: 0.4412 - Val ROC-AUC: 0.6957 - Val PR-AUC: 0.3872
[Fine-tune] Epoch 36/50 - Loss: 0.5357 - Val F1: 0.4179 - Val ROC-AUC: 0.6931 - Val PR-AUC: 0.3798
[Fine-tune] Epoch 37/50 - Loss: 0.5604 - Val F1: 0.4179 - Val ROC-AUC: 0.6913 - Val PR-AUC: 0.3808
[Fine-tune] Epoch 38/50 - Loss: 0.5498 - Val F1: 0.3944 - Val ROC-AUC: 0.6934 - Val PR-AUC: 0.3822
[Fine-tune] Epoch 39/50 - Loss: 0.5532 - Val F1: 0.4058 - Val ROC-AUC: 0.6863 - Val PR-AUC: 0.3807
[Fine-tune] Epoch 40/50 - Loss: 0.5445 - Val F1: 0.4054 - Val ROC-AUC: 0.6915 - Val PR-AUC: 0.3885
[Fine-tune] Epoch 41/50 - Loss: 0.5359 - Val F1: 0.3944 - Val ROC-AUC: 0.6910 - Val PR-AUC: 0.3877
[Fine-tune] Epoch 42/50 - Loss: 0.5603 - Val F1: 0.4118 - Val ROC-AUC: 0.6922 - Val PR-AUC: 0.3883
[Fine-tune] Epoch 43/50 - Loss: 0.5728 - Val F1: 0.3944 - Val ROC-AUC: 0.6887 - Val PR-AUC: 0.3816
[Fine-tune] Epoch 44/50 - Loss: 0.5316 - Val F1: 0.4058 - Val ROC-AUC: 0.6894 - Val PR-AUC: 0.3804
[Fine-tune] Epoch 45/50 - Loss: 0.5547 - Val F1: 0.4058 - Val ROC-AUC: 0.6891 - Val PR-AUC: 0.3827
[Fine-tune] Epoch 46/50 - Loss: 0.5419 - Val F1: 0.4118 - Val ROC-AUC: 0.6929 - Val PR-AUC: 0.3830
[Fine-tune] Epoch 47/50 - Loss: 0.5436 - Val F1: 0.3944 - Val ROC-AUC: 0.6901 - Val PR-AUC: 0.3830
[Fine-tune] Epoch 48/50 - Loss: 0.5350 - Val F1: 0.4000 - Val ROC-AUC: 0.6913 - Val PR-AUC: 0.3810
[Fine-tune] Epoch 49/50 - Loss: 0.5393 - Val F1: 0.4000 - Val ROC-AUC: 0.6915 - Val PR-AUC: 0.3775
[Fine-tune] Epoch 50/50 - Loss: 0.5517 - Val F1: 0.4179 - Val ROC-AUC: 0.6938 - Val PR-AUC: 0.3790
Finetuning completed. Test F1: 0.5846, ROC-AUC: 0.8480, PR-AUC: 0.5173
[3.1/4] Target-only training on OT_ER_ERaERb_1440 using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_OT_ER_ERaERb_1440_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.5063, ROC-AUC: 0.8008, PR-AUC: 0.4863
✅ 실험 완료: TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability -> OT_ER_ERaERb_1440 [GAT]
