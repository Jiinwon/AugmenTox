[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERb_BLA_Agonist_viability_gat.pth, loading...
[3/4] Finetuning on OT_ER_ERaERb_1440 using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6515 - Val F1: 0.3364 - Val ROC-AUC: 0.6537 - Val PR-AUC: 0.3277
[Fine-tune] Epoch 2/50 - Loss: 0.6194 - Val F1: 0.3158 - Val ROC-AUC: 0.6584 - Val PR-AUC: 0.3458
[Fine-tune] Epoch 3/50 - Loss: 0.6414 - Val F1: 0.3733 - Val ROC-AUC: 0.6854 - Val PR-AUC: 0.4196
[Fine-tune] Epoch 4/50 - Loss: 0.6377 - Val F1: 0.3373 - Val ROC-AUC: 0.6671 - Val PR-AUC: 0.3813
[Fine-tune] Epoch 5/50 - Loss: 0.6246 - Val F1: 0.3607 - Val ROC-AUC: 0.6609 - Val PR-AUC: 0.3905
[Fine-tune] Epoch 6/50 - Loss: 0.6082 - Val F1: 0.3836 - Val ROC-AUC: 0.6577 - Val PR-AUC: 0.4043
[Fine-tune] Epoch 7/50 - Loss: 0.6071 - Val F1: 0.3797 - Val ROC-AUC: 0.6626 - Val PR-AUC: 0.3988
[Fine-tune] Epoch 8/50 - Loss: 0.5958 - Val F1: 0.3684 - Val ROC-AUC: 0.6694 - Val PR-AUC: 0.3677
[Fine-tune] Epoch 9/50 - Loss: 0.6084 - Val F1: 0.4156 - Val ROC-AUC: 0.6668 - Val PR-AUC: 0.3855
[Fine-tune] Epoch 10/50 - Loss: 0.5930 - Val F1: 0.3846 - Val ROC-AUC: 0.6666 - Val PR-AUC: 0.3610
[Fine-tune] Epoch 11/50 - Loss: 0.5984 - Val F1: 0.4000 - Val ROC-AUC: 0.6685 - Val PR-AUC: 0.3746
[Fine-tune] Epoch 12/50 - Loss: 0.5828 - Val F1: 0.4058 - Val ROC-AUC: 0.6720 - Val PR-AUC: 0.3791
[Fine-tune] Epoch 13/50 - Loss: 0.6022 - Val F1: 0.3784 - Val ROC-AUC: 0.6720 - Val PR-AUC: 0.3888
[Fine-tune] Epoch 14/50 - Loss: 0.5899 - Val F1: 0.4103 - Val ROC-AUC: 0.6762 - Val PR-AUC: 0.3937
[Fine-tune] Epoch 15/50 - Loss: 0.5738 - Val F1: 0.4545 - Val ROC-AUC: 0.6866 - Val PR-AUC: 0.3964
[Fine-tune] Epoch 16/50 - Loss: 0.5868 - Val F1: 0.4179 - Val ROC-AUC: 0.6891 - Val PR-AUC: 0.3759
[Fine-tune] Epoch 17/50 - Loss: 0.5835 - Val F1: 0.4054 - Val ROC-AUC: 0.6840 - Val PR-AUC: 0.3695
[Fine-tune] Epoch 18/50 - Loss: 0.5966 - Val F1: 0.4225 - Val ROC-AUC: 0.6765 - Val PR-AUC: 0.4048
[Fine-tune] Epoch 19/50 - Loss: 0.5631 - Val F1: 0.4167 - Val ROC-AUC: 0.6767 - Val PR-AUC: 0.3940
[Fine-tune] Epoch 20/50 - Loss: 0.5889 - Val F1: 0.4118 - Val ROC-AUC: 0.6725 - Val PR-AUC: 0.3865
[Fine-tune] Epoch 21/50 - Loss: 0.5821 - Val F1: 0.4375 - Val ROC-AUC: 0.6750 - Val PR-AUC: 0.3932
[Fine-tune] Epoch 22/50 - Loss: 0.5932 - Val F1: 0.4211 - Val ROC-AUC: 0.6800 - Val PR-AUC: 0.3830
[Fine-tune] Epoch 23/50 - Loss: 0.5785 - Val F1: 0.4225 - Val ROC-AUC: 0.6821 - Val PR-AUC: 0.3894
[Fine-tune] Epoch 24/50 - Loss: 0.5895 - Val F1: 0.4242 - Val ROC-AUC: 0.6842 - Val PR-AUC: 0.3942
[Fine-tune] Epoch 25/50 - Loss: 0.5819 - Val F1: 0.4058 - Val ROC-AUC: 0.6835 - Val PR-AUC: 0.3898
[Fine-tune] Epoch 26/50 - Loss: 0.5917 - Val F1: 0.4384 - Val ROC-AUC: 0.6873 - Val PR-AUC: 0.3851
[Fine-tune] Epoch 27/50 - Loss: 0.5661 - Val F1: 0.4110 - Val ROC-AUC: 0.6812 - Val PR-AUC: 0.3983
[Fine-tune] Epoch 28/50 - Loss: 0.5956 - Val F1: 0.4058 - Val ROC-AUC: 0.6894 - Val PR-AUC: 0.4022
[Fine-tune] Epoch 29/50 - Loss: 0.5649 - Val F1: 0.3636 - Val ROC-AUC: 0.6868 - Val PR-AUC: 0.3941
[Fine-tune] Epoch 30/50 - Loss: 0.5939 - Val F1: 0.4118 - Val ROC-AUC: 0.6861 - Val PR-AUC: 0.3940
[Fine-tune] Epoch 31/50 - Loss: 0.5785 - Val F1: 0.4058 - Val ROC-AUC: 0.6847 - Val PR-AUC: 0.3935
[Fine-tune] Epoch 32/50 - Loss: 0.5695 - Val F1: 0.4167 - Val ROC-AUC: 0.6882 - Val PR-AUC: 0.3971
[Fine-tune] Epoch 33/50 - Loss: 0.5656 - Val F1: 0.4225 - Val ROC-AUC: 0.6887 - Val PR-AUC: 0.3864
[Fine-tune] Epoch 34/50 - Loss: 0.5772 - Val F1: 0.4167 - Val ROC-AUC: 0.6870 - Val PR-AUC: 0.3831
[Fine-tune] Epoch 35/50 - Loss: 0.5684 - Val F1: 0.4179 - Val ROC-AUC: 0.6884 - Val PR-AUC: 0.3861
[Fine-tune] Epoch 36/50 - Loss: 0.5707 - Val F1: 0.4167 - Val ROC-AUC: 0.6894 - Val PR-AUC: 0.3792
[Fine-tune] Epoch 37/50 - Loss: 0.5629 - Val F1: 0.4000 - Val ROC-AUC: 0.6842 - Val PR-AUC: 0.3751
[Fine-tune] Epoch 38/50 - Loss: 0.5669 - Val F1: 0.4000 - Val ROC-AUC: 0.6840 - Val PR-AUC: 0.3786
[Fine-tune] Epoch 39/50 - Loss: 0.5895 - Val F1: 0.4478 - Val ROC-AUC: 0.6884 - Val PR-AUC: 0.3791
[Fine-tune] Epoch 40/50 - Loss: 0.5616 - Val F1: 0.4225 - Val ROC-AUC: 0.6835 - Val PR-AUC: 0.3862
[Fine-tune] Epoch 41/50 - Loss: 0.5796 - Val F1: 0.4054 - Val ROC-AUC: 0.6868 - Val PR-AUC: 0.3814
[Fine-tune] Epoch 42/50 - Loss: 0.5930 - Val F1: 0.4000 - Val ROC-AUC: 0.6835 - Val PR-AUC: 0.3805
[Fine-tune] Epoch 43/50 - Loss: 0.5747 - Val F1: 0.4058 - Val ROC-AUC: 0.6821 - Val PR-AUC: 0.3710
[Fine-tune] Epoch 44/50 - Loss: 0.5846 - Val F1: 0.3944 - Val ROC-AUC: 0.6805 - Val PR-AUC: 0.3715
[Fine-tune] Epoch 45/50 - Loss: 0.5685 - Val F1: 0.3896 - Val ROC-AUC: 0.6830 - Val PR-AUC: 0.3744
[Fine-tune] Epoch 46/50 - Loss: 0.5899 - Val F1: 0.4054 - Val ROC-AUC: 0.6842 - Val PR-AUC: 0.3739
[Fine-tune] Epoch 47/50 - Loss: 0.5749 - Val F1: 0.4058 - Val ROC-AUC: 0.6847 - Val PR-AUC: 0.3763
[Fine-tune] Epoch 48/50 - Loss: 0.5879 - Val F1: 0.4348 - Val ROC-AUC: 0.6873 - Val PR-AUC: 0.3778
[Fine-tune] Epoch 49/50 - Loss: 0.5734 - Val F1: 0.4225 - Val ROC-AUC: 0.6894 - Val PR-AUC: 0.3864
[Fine-tune] Epoch 50/50 - Loss: 0.5544 - Val F1: 0.4225 - Val ROC-AUC: 0.6913 - Val PR-AUC: 0.3831
Finetuning completed. Test F1: 0.4324, ROC-AUC: 0.8339, PR-AUC: 0.4667
[3.1/4] Target-only training on OT_ER_ERaERb_1440 using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_OT_ER_ERaERb_1440_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.5063, ROC-AUC: 0.8008, PR-AUC: 0.4863
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> OT_ER_ERaERb_1440 [GAT]
