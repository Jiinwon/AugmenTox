[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERa_LUC_VM7_Agonist using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERa_LUC_VM7_Agonist_gat.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6251 - Val F1: 0.3889 - Val ROC-AUC: 0.8224 - Val PR-AUC: 0.5917
[Fine-tune] Epoch 2/50 - Loss: 0.6052 - Val F1: 0.4118 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.6090
[Fine-tune] Epoch 3/50 - Loss: 0.5673 - Val F1: 0.4727 - Val ROC-AUC: 0.8279 - Val PR-AUC: 0.6199
[Fine-tune] Epoch 4/50 - Loss: 0.5773 - Val F1: 0.4528 - Val ROC-AUC: 0.8026 - Val PR-AUC: 0.5788
[Fine-tune] Epoch 5/50 - Loss: 0.6013 - Val F1: 0.4727 - Val ROC-AUC: 0.8322 - Val PR-AUC: 0.6530
[Fine-tune] Epoch 6/50 - Loss: 0.5438 - Val F1: 0.4906 - Val ROC-AUC: 0.8152 - Val PR-AUC: 0.6012
[Fine-tune] Epoch 7/50 - Loss: 0.5641 - Val F1: 0.4444 - Val ROC-AUC: 0.8048 - Val PR-AUC: 0.5501
[Fine-tune] Epoch 8/50 - Loss: 0.5655 - Val F1: 0.4762 - Val ROC-AUC: 0.8109 - Val PR-AUC: 0.5568
[Fine-tune] Epoch 9/50 - Loss: 0.5567 - Val F1: 0.5000 - Val ROC-AUC: 0.8454 - Val PR-AUC: 0.6793
[Fine-tune] Epoch 10/50 - Loss: 0.5449 - Val F1: 0.5098 - Val ROC-AUC: 0.8344 - Val PR-AUC: 0.6566
[Fine-tune] Epoch 11/50 - Loss: 0.5425 - Val F1: 0.4800 - Val ROC-AUC: 0.8059 - Val PR-AUC: 0.6346
[Fine-tune] Epoch 12/50 - Loss: 0.5487 - Val F1: 0.4706 - Val ROC-AUC: 0.8289 - Val PR-AUC: 0.6431
[Fine-tune] Epoch 13/50 - Loss: 0.5433 - Val F1: 0.5283 - Val ROC-AUC: 0.8531 - Val PR-AUC: 0.6779
[Fine-tune] Epoch 14/50 - Loss: 0.5333 - Val F1: 0.5833 - Val ROC-AUC: 0.8498 - Val PR-AUC: 0.6805
[Fine-tune] Epoch 15/50 - Loss: 0.5390 - Val F1: 0.5283 - Val ROC-AUC: 0.8558 - Val PR-AUC: 0.6851
[Fine-tune] Epoch 16/50 - Loss: 0.5428 - Val F1: 0.5000 - Val ROC-AUC: 0.8448 - Val PR-AUC: 0.6688
[Fine-tune] Epoch 17/50 - Loss: 0.5519 - Val F1: 0.5714 - Val ROC-AUC: 0.8509 - Val PR-AUC: 0.6650
[Fine-tune] Epoch 18/50 - Loss: 0.5522 - Val F1: 0.5217 - Val ROC-AUC: 0.8514 - Val PR-AUC: 0.6572
[Fine-tune] Epoch 19/50 - Loss: 0.5586 - Val F1: 0.5306 - Val ROC-AUC: 0.8580 - Val PR-AUC: 0.6869
[Fine-tune] Epoch 20/50 - Loss: 0.5170 - Val F1: 0.4681 - Val ROC-AUC: 0.8448 - Val PR-AUC: 0.6553
[Fine-tune] Epoch 21/50 - Loss: 0.5541 - Val F1: 0.5238 - Val ROC-AUC: 0.8421 - Val PR-AUC: 0.6622
[Fine-tune] Epoch 22/50 - Loss: 0.5444 - Val F1: 0.5238 - Val ROC-AUC: 0.8443 - Val PR-AUC: 0.6581
[Fine-tune] Epoch 23/50 - Loss: 0.5061 - Val F1: 0.5366 - Val ROC-AUC: 0.8564 - Val PR-AUC: 0.6777
[Fine-tune] Epoch 24/50 - Loss: 0.5448 - Val F1: 0.5417 - Val ROC-AUC: 0.8596 - Val PR-AUC: 0.6792
[Fine-tune] Epoch 25/50 - Loss: 0.5271 - Val F1: 0.5532 - Val ROC-AUC: 0.8586 - Val PR-AUC: 0.6789
[Fine-tune] Epoch 26/50 - Loss: 0.5354 - Val F1: 0.5000 - Val ROC-AUC: 0.8503 - Val PR-AUC: 0.6612
[Fine-tune] Epoch 27/50 - Loss: 0.5481 - Val F1: 0.5306 - Val ROC-AUC: 0.8542 - Val PR-AUC: 0.6729
[Fine-tune] Epoch 28/50 - Loss: 0.5304 - Val F1: 0.5405 - Val ROC-AUC: 0.8531 - Val PR-AUC: 0.6766
[Fine-tune] Epoch 29/50 - Loss: 0.5215 - Val F1: 0.5263 - Val ROC-AUC: 0.8481 - Val PR-AUC: 0.6603
[Fine-tune] Epoch 30/50 - Loss: 0.5189 - Val F1: 0.5098 - Val ROC-AUC: 0.8443 - Val PR-AUC: 0.6551
[Fine-tune] Epoch 31/50 - Loss: 0.5167 - Val F1: 0.4889 - Val ROC-AUC: 0.8416 - Val PR-AUC: 0.6529
[Fine-tune] Epoch 32/50 - Loss: 0.5396 - Val F1: 0.5000 - Val ROC-AUC: 0.8443 - Val PR-AUC: 0.6574
[Fine-tune] Epoch 33/50 - Loss: 0.5617 - Val F1: 0.4889 - Val ROC-AUC: 0.8514 - Val PR-AUC: 0.6712
[Fine-tune] Epoch 34/50 - Loss: 0.5529 - Val F1: 0.5217 - Val ROC-AUC: 0.8498 - Val PR-AUC: 0.6654
[Fine-tune] Epoch 35/50 - Loss: 0.5247 - Val F1: 0.4898 - Val ROC-AUC: 0.8481 - Val PR-AUC: 0.6677
[Fine-tune] Epoch 36/50 - Loss: 0.5140 - Val F1: 0.5000 - Val ROC-AUC: 0.8525 - Val PR-AUC: 0.6719
[Fine-tune] Epoch 37/50 - Loss: 0.5353 - Val F1: 0.5405 - Val ROC-AUC: 0.8602 - Val PR-AUC: 0.6815
[Fine-tune] Epoch 38/50 - Loss: 0.5340 - Val F1: 0.5263 - Val ROC-AUC: 0.8531 - Val PR-AUC: 0.6703
[Fine-tune] Epoch 39/50 - Loss: 0.5404 - Val F1: 0.5116 - Val ROC-AUC: 0.8476 - Val PR-AUC: 0.6683
[Fine-tune] Epoch 40/50 - Loss: 0.5494 - Val F1: 0.5128 - Val ROC-AUC: 0.8454 - Val PR-AUC: 0.6580
[Fine-tune] Epoch 41/50 - Loss: 0.5185 - Val F1: 0.5000 - Val ROC-AUC: 0.8443 - Val PR-AUC: 0.6560
[Fine-tune] Epoch 42/50 - Loss: 0.5308 - Val F1: 0.5455 - Val ROC-AUC: 0.8498 - Val PR-AUC: 0.6709
[Fine-tune] Epoch 43/50 - Loss: 0.5369 - Val F1: 0.5263 - Val ROC-AUC: 0.8520 - Val PR-AUC: 0.6727
[Fine-tune] Epoch 44/50 - Loss: 0.5141 - Val F1: 0.5641 - Val ROC-AUC: 0.8498 - Val PR-AUC: 0.6712
[Fine-tune] Epoch 45/50 - Loss: 0.5140 - Val F1: 0.5405 - Val ROC-AUC: 0.8542 - Val PR-AUC: 0.6748
[Fine-tune] Epoch 46/50 - Loss: 0.5183 - Val F1: 0.5128 - Val ROC-AUC: 0.8536 - Val PR-AUC: 0.6754
[Fine-tune] Epoch 47/50 - Loss: 0.5465 - Val F1: 0.5500 - Val ROC-AUC: 0.8536 - Val PR-AUC: 0.6762
[Fine-tune] Epoch 48/50 - Loss: 0.5158 - Val F1: 0.5405 - Val ROC-AUC: 0.8509 - Val PR-AUC: 0.6712
[Fine-tune] Epoch 49/50 - Loss: 0.5096 - Val F1: 0.5500 - Val ROC-AUC: 0.8481 - Val PR-AUC: 0.6678
[Fine-tune] Epoch 50/50 - Loss: 0.5456 - Val F1: 0.5455 - Val ROC-AUC: 0.8487 - Val PR-AUC: 0.6707
Finetuning completed. Test F1: 0.4889, ROC-AUC: 0.7320, PR-AUC: 0.5993
[3.1/4] Target-only training on NVS_NR_hER using GAT...
=== Target-only training ===
[Target-only] Epoch 1/50 – Loss: 0.6269  Val F1: 0.2836  ROC-AUC: 0.7226  PR-AUC: 0.4949
[Target-only] Epoch 2/50 – Loss: 0.6276  Val F1: 0.2975  ROC-AUC: 0.7341  PR-AUC: 0.4731
[Target-only] Epoch 3/50 – Loss: 0.6058  Val F1: 0.3288  ROC-AUC: 0.7286  PR-AUC: 0.4809
[Target-only] Epoch 4/50 – Loss: 0.6067  Val F1: 0.3636  ROC-AUC: 0.7664  PR-AUC: 0.5305
[Target-only] Epoch 5/50 – Loss: 0.5866  Val F1: 0.4262  ROC-AUC: 0.7774  PR-AUC: 0.5647
[Target-only] Epoch 6/50 – Loss: 0.6261  Val F1: 0.4571  ROC-AUC: 0.7807  PR-AUC: 0.4395
[Target-only] Epoch 7/50 – Loss: 0.6019  Val F1: 0.4058  ROC-AUC: 0.7440  PR-AUC: 0.4674
[Target-only] Epoch 8/50 – Loss: 0.5827  Val F1: 0.4138  ROC-AUC: 0.7917  PR-AUC: 0.5367
[Target-only] Epoch 9/50 – Loss: 0.6026  Val F1: 0.3438  ROC-AUC: 0.7566  PR-AUC: 0.4416
[Target-only] Epoch 10/50 – Loss: 0.6129  Val F1: 0.3750  ROC-AUC: 0.7955  PR-AUC: 0.5468
[Target-only] Epoch 11/50 – Loss: 0.5987  Val F1: 0.3662  ROC-AUC: 0.7950  PR-AUC: 0.5952
[Target-only] Epoch 12/50 – Loss: 0.5891  Val F1: 0.4118  ROC-AUC: 0.7999  PR-AUC: 0.5751
[Target-only] Epoch 13/50 – Loss: 0.5635  Val F1: 0.4179  ROC-AUC: 0.8010  PR-AUC: 0.5456
[Target-only] Epoch 14/50 – Loss: 0.5739  Val F1: 0.4074  ROC-AUC: 0.7774  PR-AUC: 0.5465
[Target-only] Epoch 15/50 – Loss: 0.5776  Val F1: 0.3896  ROC-AUC: 0.8081  PR-AUC: 0.5832
[Target-only] Epoch 16/50 – Loss: 0.6002  Val F1: 0.4000  ROC-AUC: 0.7840  PR-AUC: 0.5403
[Target-only] Epoch 17/50 – Loss: 0.5774  Val F1: 0.4407  ROC-AUC: 0.8092  PR-AUC: 0.5779
[Target-only] Epoch 18/50 – Loss: 0.5464  Val F1: 0.4314  ROC-AUC: 0.7961  PR-AUC: 0.5491
[Target-only] Epoch 19/50 – Loss: 0.5765  Val F1: 0.4490  ROC-AUC: 0.8174  PR-AUC: 0.5870
[Target-only] Epoch 20/50 – Loss: 0.5756  Val F1: 0.4815  ROC-AUC: 0.8081  PR-AUC: 0.5866
[Target-only] Epoch 21/50 – Loss: 0.5514  Val F1: 0.4194  ROC-AUC: 0.8004  PR-AUC: 0.5779
[Target-only] Epoch 22/50 – Loss: 0.5949  Val F1: 0.4211  ROC-AUC: 0.7950  PR-AUC: 0.5661
[Target-only] Epoch 23/50 – Loss: 0.5755  Val F1: 0.4194  ROC-AUC: 0.8043  PR-AUC: 0.5751
[Target-only] Epoch 24/50 – Loss: 0.5466  Val F1: 0.4286  ROC-AUC: 0.8059  PR-AUC: 0.5766
[Target-only] Epoch 25/50 – Loss: 0.5927  Val F1: 0.4262  ROC-AUC: 0.8152  PR-AUC: 0.5723
[Target-only] Epoch 26/50 – Loss: 0.5472  Val F1: 0.4483  ROC-AUC: 0.8180  PR-AUC: 0.5803
[Target-only] Epoch 27/50 – Loss: 0.5672  Val F1: 0.4912  ROC-AUC: 0.8262  PR-AUC: 0.5923
[Target-only] Epoch 28/50 – Loss: 0.5745  Val F1: 0.4074  ROC-AUC: 0.8070  PR-AUC: 0.5819
[Target-only] Epoch 29/50 – Loss: 0.5427  Val F1: 0.3793  ROC-AUC: 0.7856  PR-AUC: 0.5667
[Target-only] Epoch 30/50 – Loss: 0.5335  Val F1: 0.4444  ROC-AUC: 0.8048  PR-AUC: 0.5620
[Target-only] Epoch 31/50 – Loss: 0.5788  Val F1: 0.4561  ROC-AUC: 0.8218  PR-AUC: 0.5798
[Target-only] Epoch 32/50 – Loss: 0.5916  Val F1: 0.4727  ROC-AUC: 0.8152  PR-AUC: 0.5933
[Target-only] Epoch 33/50 – Loss: 0.5792  Val F1: 0.4727  ROC-AUC: 0.8180  PR-AUC: 0.5815
[Target-only] Epoch 34/50 – Loss: 0.5566  Val F1: 0.4333  ROC-AUC: 0.8191  PR-AUC: 0.5854
[Target-only] Epoch 35/50 – Loss: 0.5496  Val F1: 0.4194  ROC-AUC: 0.8109  PR-AUC: 0.5790
[Target-only] Epoch 36/50 – Loss: 0.5732  Val F1: 0.4194  ROC-AUC: 0.8015  PR-AUC: 0.5697
[Target-only] Epoch 37/50 – Loss: 0.5618  Val F1: 0.4483  ROC-AUC: 0.8048  PR-AUC: 0.5777
[Target-only] Epoch 38/50 – Loss: 0.5584  Val F1: 0.4118  ROC-AUC: 0.8065  PR-AUC: 0.5608
[Target-only] Epoch 39/50 – Loss: 0.5824  Val F1: 0.4333  ROC-AUC: 0.8213  PR-AUC: 0.5938
[Target-only] Epoch 40/50 – Loss: 0.5589  Val F1: 0.4643  ROC-AUC: 0.8174  PR-AUC: 0.5697
[Target-only] Epoch 41/50 – Loss: 0.5685  Val F1: 0.4561  ROC-AUC: 0.8257  PR-AUC: 0.5808
[Target-only] Epoch 42/50 – Loss: 0.5309  Val F1: 0.5000  ROC-AUC: 0.8306  PR-AUC: 0.5859
[Target-only] Epoch 43/50 – Loss: 0.5695  Val F1: 0.5000  ROC-AUC: 0.8246  PR-AUC: 0.5805
[Target-only] Epoch 44/50 – Loss: 0.5810  Val F1: 0.4906  ROC-AUC: 0.8213  PR-AUC: 0.5898
[Target-only] Epoch 45/50 – Loss: 0.5589  Val F1: 0.4561  ROC-AUC: 0.8224  PR-AUC: 0.5899
[Target-only] Epoch 46/50 – Loss: 0.5411  Val F1: 0.4727  ROC-AUC: 0.8191  PR-AUC: 0.5738
[Target-only] Epoch 47/50 – Loss: 0.5578  Val F1: 0.4727  ROC-AUC: 0.8202  PR-AUC: 0.5912
[Target-only] Epoch 48/50 – Loss: 0.5578  Val F1: 0.4815  ROC-AUC: 0.8306  PR-AUC: 0.5856
[Target-only] Epoch 49/50 – Loss: 0.5310  Val F1: 0.4906  ROC-AUC: 0.8279  PR-AUC: 0.5825
[Target-only] Epoch 50/50 – Loss: 0.5632  Val F1: 0.4561  ROC-AUC: 0.8224  PR-AUC: 0.5722
=== Target-only TEST performance ===
Test F1: 0.4314, ROC-AUC: 0.7092, PR-AUC: 0.5907
✅ 실험 완료: TOX21_ERa_LUC_VM7_Agonist -> NVS_NR_hER [GAT]
