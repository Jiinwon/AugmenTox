[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERR_LUC_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERR_LUC_viability_gat.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6844 - Val F1: 0.4348 - Val ROC-AUC: 0.7774 - Val PR-AUC: 0.4871
[Fine-tune] Epoch 2/50 - Loss: 0.6179 - Val F1: 0.4333 - Val ROC-AUC: 0.7966 - Val PR-AUC: 0.5844
[Fine-tune] Epoch 3/50 - Loss: 0.6243 - Val F1: 0.3793 - Val ROC-AUC: 0.7648 - Val PR-AUC: 0.5461
[Fine-tune] Epoch 4/50 - Loss: 0.6226 - Val F1: 0.4000 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.6285
[Fine-tune] Epoch 5/50 - Loss: 0.5908 - Val F1: 0.4583 - Val ROC-AUC: 0.7966 - Val PR-AUC: 0.6034
[Fine-tune] Epoch 6/50 - Loss: 0.5943 - Val F1: 0.4783 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6270
[Fine-tune] Epoch 7/50 - Loss: 0.6034 - Val F1: 0.5000 - Val ROC-AUC: 0.8542 - Val PR-AUC: 0.6441
[Fine-tune] Epoch 8/50 - Loss: 0.6025 - Val F1: 0.4889 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6333
[Fine-tune] Epoch 9/50 - Loss: 0.5856 - Val F1: 0.5217 - Val ROC-AUC: 0.8476 - Val PR-AUC: 0.6444
[Fine-tune] Epoch 10/50 - Loss: 0.5736 - Val F1: 0.5217 - Val ROC-AUC: 0.8273 - Val PR-AUC: 0.6338
[Fine-tune] Epoch 11/50 - Loss: 0.5804 - Val F1: 0.5333 - Val ROC-AUC: 0.8355 - Val PR-AUC: 0.6515
[Fine-tune] Epoch 12/50 - Loss: 0.5706 - Val F1: 0.5000 - Val ROC-AUC: 0.8300 - Val PR-AUC: 0.6342
[Fine-tune] Epoch 13/50 - Loss: 0.5931 - Val F1: 0.5000 - Val ROC-AUC: 0.8350 - Val PR-AUC: 0.6376
[Fine-tune] Epoch 14/50 - Loss: 0.5681 - Val F1: 0.5000 - Val ROC-AUC: 0.8191 - Val PR-AUC: 0.6172
[Fine-tune] Epoch 15/50 - Loss: 0.5686 - Val F1: 0.5106 - Val ROC-AUC: 0.8300 - Val PR-AUC: 0.6170
[Fine-tune] Epoch 16/50 - Loss: 0.5559 - Val F1: 0.5217 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6100
[Fine-tune] Epoch 17/50 - Loss: 0.5970 - Val F1: 0.5000 - Val ROC-AUC: 0.8136 - Val PR-AUC: 0.6018
[Fine-tune] Epoch 18/50 - Loss: 0.5454 - Val F1: 0.4762 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.6000
[Fine-tune] Epoch 19/50 - Loss: 0.5846 - Val F1: 0.4348 - Val ROC-AUC: 0.8114 - Val PR-AUC: 0.6082
[Fine-tune] Epoch 20/50 - Loss: 0.5835 - Val F1: 0.4444 - Val ROC-AUC: 0.8207 - Val PR-AUC: 0.6152
[Fine-tune] Epoch 21/50 - Loss: 0.5866 - Val F1: 0.4651 - Val ROC-AUC: 0.8224 - Val PR-AUC: 0.6165
[Fine-tune] Epoch 22/50 - Loss: 0.5740 - Val F1: 0.4651 - Val ROC-AUC: 0.8311 - Val PR-AUC: 0.6258
[Fine-tune] Epoch 23/50 - Loss: 0.5642 - Val F1: 0.4762 - Val ROC-AUC: 0.8273 - Val PR-AUC: 0.6178
[Fine-tune] Epoch 24/50 - Loss: 0.5546 - Val F1: 0.5000 - Val ROC-AUC: 0.8289 - Val PR-AUC: 0.6280
[Fine-tune] Epoch 25/50 - Loss: 0.5423 - Val F1: 0.4762 - Val ROC-AUC: 0.8251 - Val PR-AUC: 0.6149
[Fine-tune] Epoch 26/50 - Loss: 0.5363 - Val F1: 0.4878 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.6068
[Fine-tune] Epoch 27/50 - Loss: 0.5826 - Val F1: 0.4651 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.6019
[Fine-tune] Epoch 28/50 - Loss: 0.5700 - Val F1: 0.4762 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.6177
[Fine-tune] Epoch 29/50 - Loss: 0.5500 - Val F1: 0.4651 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6299
[Fine-tune] Epoch 30/50 - Loss: 0.5721 - Val F1: 0.4545 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.6275
[Fine-tune] Epoch 31/50 - Loss: 0.5874 - Val F1: 0.4545 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.6184
[Fine-tune] Epoch 32/50 - Loss: 0.5401 - Val F1: 0.4545 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.6212
[Fine-tune] Epoch 33/50 - Loss: 0.5613 - Val F1: 0.4651 - Val ROC-AUC: 0.8257 - Val PR-AUC: 0.6261
[Fine-tune] Epoch 34/50 - Loss: 0.5381 - Val F1: 0.4545 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6278
[Fine-tune] Epoch 35/50 - Loss: 0.5512 - Val F1: 0.4762 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6300
[Fine-tune] Epoch 36/50 - Loss: 0.5341 - Val F1: 0.4878 - Val ROC-AUC: 0.8246 - Val PR-AUC: 0.6310
[Fine-tune] Epoch 37/50 - Loss: 0.5216 - Val F1: 0.4762 - Val ROC-AUC: 0.8246 - Val PR-AUC: 0.6305
[Fine-tune] Epoch 38/50 - Loss: 0.5587 - Val F1: 0.4878 - Val ROC-AUC: 0.8229 - Val PR-AUC: 0.6301
[Fine-tune] Epoch 39/50 - Loss: 0.5689 - Val F1: 0.4878 - Val ROC-AUC: 0.8224 - Val PR-AUC: 0.6272
[Fine-tune] Epoch 40/50 - Loss: 0.5569 - Val F1: 0.4762 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.6289
[Fine-tune] Epoch 41/50 - Loss: 0.5420 - Val F1: 0.4762 - Val ROC-AUC: 0.8251 - Val PR-AUC: 0.6302
[Fine-tune] Epoch 42/50 - Loss: 0.5361 - Val F1: 0.4762 - Val ROC-AUC: 0.8262 - Val PR-AUC: 0.6326
[Fine-tune] Epoch 43/50 - Loss: 0.5477 - Val F1: 0.4762 - Val ROC-AUC: 0.8268 - Val PR-AUC: 0.6305
[Fine-tune] Epoch 44/50 - Loss: 0.5644 - Val F1: 0.4762 - Val ROC-AUC: 0.8229 - Val PR-AUC: 0.6275
[Fine-tune] Epoch 45/50 - Loss: 0.5618 - Val F1: 0.4762 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.6262
[Fine-tune] Epoch 46/50 - Loss: 0.5759 - Val F1: 0.4762 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.6322
[Fine-tune] Epoch 47/50 - Loss: 0.5460 - Val F1: 0.4762 - Val ROC-AUC: 0.8229 - Val PR-AUC: 0.6311
[Fine-tune] Epoch 48/50 - Loss: 0.5806 - Val F1: 0.4762 - Val ROC-AUC: 0.8229 - Val PR-AUC: 0.6291
[Fine-tune] Epoch 49/50 - Loss: 0.5593 - Val F1: 0.5000 - Val ROC-AUC: 0.8180 - Val PR-AUC: 0.6243
[Fine-tune] Epoch 50/50 - Loss: 0.5460 - Val F1: 0.4651 - Val ROC-AUC: 0.8229 - Val PR-AUC: 0.6287
Finetuning completed. Test F1: 0.4074, ROC-AUC: 0.7613, PR-AUC: 0.5487
[3.1/4] Target-only training on NVS_NR_hER using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_NVS_NR_hER_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.4314, ROC-AUC: 0.7092, PR-AUC: 0.5907
✅ 실험 완료: TOX21_ERR_LUC_viability -> NVS_NR_hER [GAT]
