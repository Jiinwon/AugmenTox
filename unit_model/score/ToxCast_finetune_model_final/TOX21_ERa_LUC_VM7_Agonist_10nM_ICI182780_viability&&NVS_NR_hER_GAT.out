[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability_gat.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6759 - Val F1: 0.4333 - Val ROC-AUC: 0.7878 - Val PR-AUC: 0.4800
[Fine-tune] Epoch 2/50 - Loss: 0.6370 - Val F1: 0.4000 - Val ROC-AUC: 0.7670 - Val PR-AUC: 0.4849
[Fine-tune] Epoch 3/50 - Loss: 0.6034 - Val F1: 0.4643 - Val ROC-AUC: 0.7928 - Val PR-AUC: 0.5099
[Fine-tune] Epoch 4/50 - Loss: 0.6108 - Val F1: 0.4706 - Val ROC-AUC: 0.8125 - Val PR-AUC: 0.5441
[Fine-tune] Epoch 5/50 - Loss: 0.6111 - Val F1: 0.4889 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5467
[Fine-tune] Epoch 6/50 - Loss: 0.5794 - Val F1: 0.5200 - Val ROC-AUC: 0.8311 - Val PR-AUC: 0.5587
[Fine-tune] Epoch 7/50 - Loss: 0.5884 - Val F1: 0.5333 - Val ROC-AUC: 0.8300 - Val PR-AUC: 0.5523
[Fine-tune] Epoch 8/50 - Loss: 0.5946 - Val F1: 0.5238 - Val ROC-AUC: 0.8339 - Val PR-AUC: 0.5567
[Fine-tune] Epoch 9/50 - Loss: 0.5772 - Val F1: 0.4889 - Val ROC-AUC: 0.8295 - Val PR-AUC: 0.5720
[Fine-tune] Epoch 10/50 - Loss: 0.5957 - Val F1: 0.5417 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.5613
[Fine-tune] Epoch 11/50 - Loss: 0.5561 - Val F1: 0.5116 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5589
[Fine-tune] Epoch 12/50 - Loss: 0.5683 - Val F1: 0.5238 - Val ROC-AUC: 0.8262 - Val PR-AUC: 0.5675
[Fine-tune] Epoch 13/50 - Loss: 0.5556 - Val F1: 0.5238 - Val ROC-AUC: 0.8289 - Val PR-AUC: 0.5640
[Fine-tune] Epoch 14/50 - Loss: 0.5988 - Val F1: 0.4889 - Val ROC-AUC: 0.8224 - Val PR-AUC: 0.5457
[Fine-tune] Epoch 15/50 - Loss: 0.5651 - Val F1: 0.4889 - Val ROC-AUC: 0.8196 - Val PR-AUC: 0.5373
[Fine-tune] Epoch 16/50 - Loss: 0.5457 - Val F1: 0.4878 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5396
[Fine-tune] Epoch 17/50 - Loss: 0.5758 - Val F1: 0.5128 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5409
[Fine-tune] Epoch 18/50 - Loss: 0.5565 - Val F1: 0.5128 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.5484
[Fine-tune] Epoch 19/50 - Loss: 0.5319 - Val F1: 0.5500 - Val ROC-AUC: 0.8262 - Val PR-AUC: 0.5619
[Fine-tune] Epoch 20/50 - Loss: 0.5531 - Val F1: 0.5366 - Val ROC-AUC: 0.8257 - Val PR-AUC: 0.5610
[Fine-tune] Epoch 21/50 - Loss: 0.5421 - Val F1: 0.5366 - Val ROC-AUC: 0.8268 - Val PR-AUC: 0.5598
[Fine-tune] Epoch 22/50 - Loss: 0.5331 - Val F1: 0.5106 - Val ROC-AUC: 0.8235 - Val PR-AUC: 0.5509
[Fine-tune] Epoch 23/50 - Loss: 0.5774 - Val F1: 0.5333 - Val ROC-AUC: 0.8235 - Val PR-AUC: 0.5546
[Fine-tune] Epoch 24/50 - Loss: 0.5291 - Val F1: 0.5000 - Val ROC-AUC: 0.8235 - Val PR-AUC: 0.5508
[Fine-tune] Epoch 25/50 - Loss: 0.5501 - Val F1: 0.4651 - Val ROC-AUC: 0.8207 - Val PR-AUC: 0.5502
[Fine-tune] Epoch 26/50 - Loss: 0.5694 - Val F1: 0.4889 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.5506
[Fine-tune] Epoch 27/50 - Loss: 0.5656 - Val F1: 0.5000 - Val ROC-AUC: 0.8202 - Val PR-AUC: 0.5490
[Fine-tune] Epoch 28/50 - Loss: 0.5489 - Val F1: 0.4878 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.5580
[Fine-tune] Epoch 29/50 - Loss: 0.5576 - Val F1: 0.5116 - Val ROC-AUC: 0.8273 - Val PR-AUC: 0.5607
[Fine-tune] Epoch 30/50 - Loss: 0.5424 - Val F1: 0.5455 - Val ROC-AUC: 0.8235 - Val PR-AUC: 0.5602
[Fine-tune] Epoch 31/50 - Loss: 0.5372 - Val F1: 0.5366 - Val ROC-AUC: 0.8240 - Val PR-AUC: 0.5608
[Fine-tune] Epoch 32/50 - Loss: 0.5494 - Val F1: 0.5238 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.5546
[Fine-tune] Epoch 33/50 - Loss: 0.5292 - Val F1: 0.5238 - Val ROC-AUC: 0.8224 - Val PR-AUC: 0.5550
[Fine-tune] Epoch 34/50 - Loss: 0.5569 - Val F1: 0.5366 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.5513
[Fine-tune] Epoch 35/50 - Loss: 0.5543 - Val F1: 0.5500 - Val ROC-AUC: 0.8196 - Val PR-AUC: 0.5500
[Fine-tune] Epoch 36/50 - Loss: 0.5441 - Val F1: 0.5789 - Val ROC-AUC: 0.8191 - Val PR-AUC: 0.5473
[Fine-tune] Epoch 37/50 - Loss: 0.5478 - Val F1: 0.5641 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.5430
[Fine-tune] Epoch 38/50 - Loss: 0.5564 - Val F1: 0.5238 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5430
[Fine-tune] Epoch 39/50 - Loss: 0.5384 - Val F1: 0.5500 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.5518
[Fine-tune] Epoch 40/50 - Loss: 0.5383 - Val F1: 0.5366 - Val ROC-AUC: 0.8152 - Val PR-AUC: 0.5494
[Fine-tune] Epoch 41/50 - Loss: 0.5331 - Val F1: 0.5366 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5465
[Fine-tune] Epoch 42/50 - Loss: 0.5495 - Val F1: 0.5556 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5581
[Fine-tune] Epoch 43/50 - Loss: 0.5209 - Val F1: 0.5641 - Val ROC-AUC: 0.8169 - Val PR-AUC: 0.5481
[Fine-tune] Epoch 44/50 - Loss: 0.5104 - Val F1: 0.5946 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.5586
[Fine-tune] Epoch 45/50 - Loss: 0.5334 - Val F1: 0.5556 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5512
[Fine-tune] Epoch 46/50 - Loss: 0.5355 - Val F1: 0.5366 - Val ROC-AUC: 0.8191 - Val PR-AUC: 0.5547
[Fine-tune] Epoch 47/50 - Loss: 0.5504 - Val F1: 0.5116 - Val ROC-AUC: 0.8174 - Val PR-AUC: 0.5505
[Fine-tune] Epoch 48/50 - Loss: 0.5266 - Val F1: 0.5366 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5541
[Fine-tune] Epoch 49/50 - Loss: 0.5225 - Val F1: 0.5500 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.5506
[Fine-tune] Epoch 50/50 - Loss: 0.5638 - Val F1: 0.5405 - Val ROC-AUC: 0.8207 - Val PR-AUC: 0.5521
Finetuning completed. Test F1: 0.5128, ROC-AUC: 0.7488, PR-AUC: 0.5887
[3.1/4] Target-only training on NVS_NR_hER using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_NVS_NR_hER_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.4314, ROC-AUC: 0.7092, PR-AUC: 0.5907
✅ 실험 완료: TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability -> NVS_NR_hER [GAT]
