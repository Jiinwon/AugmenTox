[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GAT...
  * Pretrained model already exists at model_save/pretrained/gat/Pretrained_TOX21_ERb_BLA_Agonist_viability_gat.pth, loading...
[3/4] Finetuning on OT_ER_ERaERa_1440 using GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6375 - Val F1: 0.2418 - Val ROC-AUC: 0.6848 - Val PR-AUC: 0.3059
[Fine-tune] Epoch 2/50 - Loss: 0.5987 - Val F1: 0.2247 - Val ROC-AUC: 0.7050 - Val PR-AUC: 0.3049
[Fine-tune] Epoch 3/50 - Loss: 0.6120 - Val F1: 0.2432 - Val ROC-AUC: 0.6818 - Val PR-AUC: 0.3334
[Fine-tune] Epoch 4/50 - Loss: 0.6065 - Val F1: 0.2093 - Val ROC-AUC: 0.6742 - Val PR-AUC: 0.3102
[Fine-tune] Epoch 5/50 - Loss: 0.6177 - Val F1: 0.2466 - Val ROC-AUC: 0.6780 - Val PR-AUC: 0.3169
[Fine-tune] Epoch 6/50 - Loss: 0.5959 - Val F1: 0.2198 - Val ROC-AUC: 0.6421 - Val PR-AUC: 0.3120
[Fine-tune] Epoch 7/50 - Loss: 0.5727 - Val F1: 0.2558 - Val ROC-AUC: 0.6753 - Val PR-AUC: 0.2924
[Fine-tune] Epoch 8/50 - Loss: 0.6042 - Val F1: 0.2198 - Val ROC-AUC: 0.6692 - Val PR-AUC: 0.3145
[Fine-tune] Epoch 9/50 - Loss: 0.5827 - Val F1: 0.2727 - Val ROC-AUC: 0.6494 - Val PR-AUC: 0.2957
[Fine-tune] Epoch 10/50 - Loss: 0.5916 - Val F1: 0.2647 - Val ROC-AUC: 0.6665 - Val PR-AUC: 0.2948
[Fine-tune] Epoch 11/50 - Loss: 0.5836 - Val F1: 0.2338 - Val ROC-AUC: 0.6688 - Val PR-AUC: 0.3316
[Fine-tune] Epoch 12/50 - Loss: 0.5603 - Val F1: 0.2769 - Val ROC-AUC: 0.6742 - Val PR-AUC: 0.3113
[Fine-tune] Epoch 13/50 - Loss: 0.5712 - Val F1: 0.2424 - Val ROC-AUC: 0.6730 - Val PR-AUC: 0.3772
[Fine-tune] Epoch 14/50 - Loss: 0.5576 - Val F1: 0.2535 - Val ROC-AUC: 0.6745 - Val PR-AUC: 0.3682
[Fine-tune] Epoch 15/50 - Loss: 0.5595 - Val F1: 0.2540 - Val ROC-AUC: 0.6696 - Val PR-AUC: 0.3728
[Fine-tune] Epoch 16/50 - Loss: 0.5611 - Val F1: 0.2727 - Val ROC-AUC: 0.6521 - Val PR-AUC: 0.3928
[Fine-tune] Epoch 17/50 - Loss: 0.5608 - Val F1: 0.2462 - Val ROC-AUC: 0.6452 - Val PR-AUC: 0.3224
[Fine-tune] Epoch 18/50 - Loss: 0.5595 - Val F1: 0.2535 - Val ROC-AUC: 0.6494 - Val PR-AUC: 0.3488
[Fine-tune] Epoch 19/50 - Loss: 0.5555 - Val F1: 0.2812 - Val ROC-AUC: 0.6555 - Val PR-AUC: 0.3255
[Fine-tune] Epoch 20/50 - Loss: 0.5490 - Val F1: 0.2727 - Val ROC-AUC: 0.6803 - Val PR-AUC: 0.3480
[Fine-tune] Epoch 21/50 - Loss: 0.5527 - Val F1: 0.2667 - Val ROC-AUC: 0.6700 - Val PR-AUC: 0.3507
[Fine-tune] Epoch 22/50 - Loss: 0.5585 - Val F1: 0.2769 - Val ROC-AUC: 0.6658 - Val PR-AUC: 0.3534
[Fine-tune] Epoch 23/50 - Loss: 0.5542 - Val F1: 0.2500 - Val ROC-AUC: 0.6684 - Val PR-AUC: 0.3308
[Fine-tune] Epoch 24/50 - Loss: 0.5599 - Val F1: 0.2769 - Val ROC-AUC: 0.6582 - Val PR-AUC: 0.3420
[Fine-tune] Epoch 25/50 - Loss: 0.5516 - Val F1: 0.2857 - Val ROC-AUC: 0.6543 - Val PR-AUC: 0.3455
[Fine-tune] Epoch 26/50 - Loss: 0.5511 - Val F1: 0.2540 - Val ROC-AUC: 0.6608 - Val PR-AUC: 0.3480
[Fine-tune] Epoch 27/50 - Loss: 0.5406 - Val F1: 0.2687 - Val ROC-AUC: 0.6547 - Val PR-AUC: 0.3594
[Fine-tune] Epoch 28/50 - Loss: 0.5549 - Val F1: 0.2857 - Val ROC-AUC: 0.6551 - Val PR-AUC: 0.3554
[Fine-tune] Epoch 29/50 - Loss: 0.5560 - Val F1: 0.2903 - Val ROC-AUC: 0.6585 - Val PR-AUC: 0.3412
[Fine-tune] Epoch 30/50 - Loss: 0.5534 - Val F1: 0.2647 - Val ROC-AUC: 0.6555 - Val PR-AUC: 0.3661
[Fine-tune] Epoch 31/50 - Loss: 0.5662 - Val F1: 0.3051 - Val ROC-AUC: 0.6593 - Val PR-AUC: 0.3662
[Fine-tune] Epoch 32/50 - Loss: 0.5536 - Val F1: 0.2857 - Val ROC-AUC: 0.6566 - Val PR-AUC: 0.3609
[Fine-tune] Epoch 33/50 - Loss: 0.5577 - Val F1: 0.2812 - Val ROC-AUC: 0.6532 - Val PR-AUC: 0.3478
[Fine-tune] Epoch 34/50 - Loss: 0.5484 - Val F1: 0.2857 - Val ROC-AUC: 0.6582 - Val PR-AUC: 0.3535
[Fine-tune] Epoch 35/50 - Loss: 0.5425 - Val F1: 0.2769 - Val ROC-AUC: 0.6528 - Val PR-AUC: 0.3496
[Fine-tune] Epoch 36/50 - Loss: 0.5526 - Val F1: 0.2812 - Val ROC-AUC: 0.6566 - Val PR-AUC: 0.3279
[Fine-tune] Epoch 37/50 - Loss: 0.5377 - Val F1: 0.2812 - Val ROC-AUC: 0.6570 - Val PR-AUC: 0.3280
[Fine-tune] Epoch 38/50 - Loss: 0.5411 - Val F1: 0.3158 - Val ROC-AUC: 0.6593 - Val PR-AUC: 0.3286
[Fine-tune] Epoch 39/50 - Loss: 0.5395 - Val F1: 0.2857 - Val ROC-AUC: 0.6616 - Val PR-AUC: 0.3182
[Fine-tune] Epoch 40/50 - Loss: 0.5240 - Val F1: 0.2951 - Val ROC-AUC: 0.6639 - Val PR-AUC: 0.3219
[Fine-tune] Epoch 41/50 - Loss: 0.5442 - Val F1: 0.2951 - Val ROC-AUC: 0.6654 - Val PR-AUC: 0.3249
[Fine-tune] Epoch 42/50 - Loss: 0.5588 - Val F1: 0.2769 - Val ROC-AUC: 0.6635 - Val PR-AUC: 0.3209
[Fine-tune] Epoch 43/50 - Loss: 0.5403 - Val F1: 0.3158 - Val ROC-AUC: 0.6604 - Val PR-AUC: 0.3202
[Fine-tune] Epoch 44/50 - Loss: 0.5271 - Val F1: 0.3000 - Val ROC-AUC: 0.6643 - Val PR-AUC: 0.3204
[Fine-tune] Epoch 45/50 - Loss: 0.5519 - Val F1: 0.2812 - Val ROC-AUC: 0.6650 - Val PR-AUC: 0.3207
[Fine-tune] Epoch 46/50 - Loss: 0.5527 - Val F1: 0.2812 - Val ROC-AUC: 0.6658 - Val PR-AUC: 0.3251
[Fine-tune] Epoch 47/50 - Loss: 0.5475 - Val F1: 0.2581 - Val ROC-AUC: 0.6669 - Val PR-AUC: 0.3274
[Fine-tune] Epoch 48/50 - Loss: 0.5550 - Val F1: 0.2759 - Val ROC-AUC: 0.6570 - Val PR-AUC: 0.3291
[Fine-tune] Epoch 49/50 - Loss: 0.5399 - Val F1: 0.3051 - Val ROC-AUC: 0.6509 - Val PR-AUC: 0.3207
[Fine-tune] Epoch 50/50 - Loss: 0.5562 - Val F1: 0.2857 - Val ROC-AUC: 0.6513 - Val PR-AUC: 0.3261
Finetuning completed. Test F1: 0.2456, ROC-AUC: 0.7842, PR-AUC: 0.3741
[3.1/4] Target-only training on OT_ER_ERaERa_1440 using GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gat/TargetOnly_OT_ER_ERaERa_1440_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.3077, ROC-AUC: 0.7685, PR-AUC: 0.1781
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> OT_ER_ERaERa_1440 [GAT]
