[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GIN_GAT...
  * Pretrained model already exists at model_save/pretrained/gin_gat/Pretrained_TOX21_ERb_BLA_Agonist_viability_gin_gat.pth, loading...
[3/4] Finetuning on ATG_ERa_TRANS using GIN_GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6192 - Val F1: 0.5140 - Val ROC-AUC: 0.7632 - Val PR-AUC: 0.4613
[Fine-tune] Epoch 2/50 - Loss: 0.5137 - Val F1: 0.4653 - Val ROC-AUC: 0.7271 - Val PR-AUC: 0.4802
[Fine-tune] Epoch 3/50 - Loss: 0.5139 - Val F1: 0.5076 - Val ROC-AUC: 0.7562 - Val PR-AUC: 0.4771
[Fine-tune] Epoch 4/50 - Loss: 0.4757 - Val F1: 0.5236 - Val ROC-AUC: 0.7505 - Val PR-AUC: 0.4955
[Fine-tune] Epoch 5/50 - Loss: 0.4724 - Val F1: 0.5376 - Val ROC-AUC: 0.7593 - Val PR-AUC: 0.4921
[Fine-tune] Epoch 6/50 - Loss: 0.4485 - Val F1: 0.5000 - Val ROC-AUC: 0.7487 - Val PR-AUC: 0.4675
[Fine-tune] Epoch 7/50 - Loss: 0.4630 - Val F1: 0.4862 - Val ROC-AUC: 0.7433 - Val PR-AUC: 0.4983
[Fine-tune] Epoch 8/50 - Loss: 0.4268 - Val F1: 0.5000 - Val ROC-AUC: 0.7414 - Val PR-AUC: 0.4835
[Fine-tune] Epoch 9/50 - Loss: 0.4359 - Val F1: 0.5340 - Val ROC-AUC: 0.7425 - Val PR-AUC: 0.4510
[Fine-tune] Epoch 10/50 - Loss: 0.4048 - Val F1: 0.4444 - Val ROC-AUC: 0.7170 - Val PR-AUC: 0.4237
[Fine-tune] Epoch 11/50 - Loss: 0.3818 - Val F1: 0.4908 - Val ROC-AUC: 0.7230 - Val PR-AUC: 0.4764
[Fine-tune] Epoch 12/50 - Loss: 0.3775 - Val F1: 0.4615 - Val ROC-AUC: 0.7140 - Val PR-AUC: 0.4577
[Fine-tune] Epoch 13/50 - Loss: 0.3665 - Val F1: 0.4649 - Val ROC-AUC: 0.7093 - Val PR-AUC: 0.4312
[Fine-tune] Epoch 14/50 - Loss: 0.3438 - Val F1: 0.4783 - Val ROC-AUC: 0.7250 - Val PR-AUC: 0.4647
[Fine-tune] Epoch 15/50 - Loss: 0.3686 - Val F1: 0.4868 - Val ROC-AUC: 0.7254 - Val PR-AUC: 0.4738
[Fine-tune] Epoch 16/50 - Loss: 0.3594 - Val F1: 0.5125 - Val ROC-AUC: 0.7236 - Val PR-AUC: 0.4912
[Fine-tune] Epoch 17/50 - Loss: 0.3268 - Val F1: 0.4720 - Val ROC-AUC: 0.7246 - Val PR-AUC: 0.4747
[Fine-tune] Epoch 18/50 - Loss: 0.3194 - Val F1: 0.4372 - Val ROC-AUC: 0.6825 - Val PR-AUC: 0.4344
[Fine-tune] Epoch 19/50 - Loss: 0.3322 - Val F1: 0.4571 - Val ROC-AUC: 0.7050 - Val PR-AUC: 0.4719
[Fine-tune] Epoch 20/50 - Loss: 0.3298 - Val F1: 0.5068 - Val ROC-AUC: 0.7116 - Val PR-AUC: 0.4917
[Fine-tune] Epoch 21/50 - Loss: 0.3108 - Val F1: 0.4805 - Val ROC-AUC: 0.6951 - Val PR-AUC: 0.4792
[Fine-tune] Epoch 22/50 - Loss: 0.2879 - Val F1: 0.4671 - Val ROC-AUC: 0.7089 - Val PR-AUC: 0.4779
[Fine-tune] Epoch 23/50 - Loss: 0.2995 - Val F1: 0.4598 - Val ROC-AUC: 0.7012 - Val PR-AUC: 0.4739
[Fine-tune] Epoch 24/50 - Loss: 0.2761 - Val F1: 0.4524 - Val ROC-AUC: 0.7017 - Val PR-AUC: 0.4581
[Fine-tune] Epoch 25/50 - Loss: 0.2640 - Val F1: 0.4483 - Val ROC-AUC: 0.7094 - Val PR-AUC: 0.4679
[Fine-tune] Epoch 26/50 - Loss: 0.2674 - Val F1: 0.4832 - Val ROC-AUC: 0.7073 - Val PR-AUC: 0.4858
[Fine-tune] Epoch 27/50 - Loss: 0.2479 - Val F1: 0.4663 - Val ROC-AUC: 0.7051 - Val PR-AUC: 0.4748
[Fine-tune] Epoch 28/50 - Loss: 0.2818 - Val F1: 0.4606 - Val ROC-AUC: 0.7021 - Val PR-AUC: 0.4743
[Fine-tune] Epoch 29/50 - Loss: 0.2684 - Val F1: 0.4865 - Val ROC-AUC: 0.6941 - Val PR-AUC: 0.4605
[Fine-tune] Epoch 30/50 - Loss: 0.2704 - Val F1: 0.4720 - Val ROC-AUC: 0.6869 - Val PR-AUC: 0.4581
[Fine-tune] Epoch 31/50 - Loss: 0.2436 - Val F1: 0.4557 - Val ROC-AUC: 0.6864 - Val PR-AUC: 0.4540
[Fine-tune] Epoch 32/50 - Loss: 0.2506 - Val F1: 0.4231 - Val ROC-AUC: 0.6868 - Val PR-AUC: 0.4494
[Fine-tune] Epoch 33/50 - Loss: 0.2382 - Val F1: 0.4487 - Val ROC-AUC: 0.6863 - Val PR-AUC: 0.4538
[Fine-tune] Epoch 34/50 - Loss: 0.2377 - Val F1: 0.4314 - Val ROC-AUC: 0.6772 - Val PR-AUC: 0.4467
[Fine-tune] Epoch 35/50 - Loss: 0.2282 - Val F1: 0.4416 - Val ROC-AUC: 0.6891 - Val PR-AUC: 0.4526
[Fine-tune] Epoch 36/50 - Loss: 0.2332 - Val F1: 0.4321 - Val ROC-AUC: 0.6936 - Val PR-AUC: 0.4653
[Fine-tune] Epoch 37/50 - Loss: 0.2286 - Val F1: 0.4224 - Val ROC-AUC: 0.6792 - Val PR-AUC: 0.4399
[Fine-tune] Epoch 38/50 - Loss: 0.2313 - Val F1: 0.4557 - Val ROC-AUC: 0.6834 - Val PR-AUC: 0.4660
[Fine-tune] Epoch 39/50 - Loss: 0.2218 - Val F1: 0.4645 - Val ROC-AUC: 0.6853 - Val PR-AUC: 0.4452
[Fine-tune] Epoch 40/50 - Loss: 0.2379 - Val F1: 0.4459 - Val ROC-AUC: 0.6862 - Val PR-AUC: 0.4536
[Fine-tune] Epoch 41/50 - Loss: 0.2088 - Val F1: 0.4596 - Val ROC-AUC: 0.6896 - Val PR-AUC: 0.4626
[Fine-tune] Epoch 42/50 - Loss: 0.2182 - Val F1: 0.4500 - Val ROC-AUC: 0.6827 - Val PR-AUC: 0.4517
[Fine-tune] Epoch 43/50 - Loss: 0.2172 - Val F1: 0.4417 - Val ROC-AUC: 0.6886 - Val PR-AUC: 0.4558
[Fine-tune] Epoch 44/50 - Loss: 0.2104 - Val F1: 0.4528 - Val ROC-AUC: 0.6866 - Val PR-AUC: 0.4501
[Fine-tune] Epoch 45/50 - Loss: 0.2046 - Val F1: 0.4540 - Val ROC-AUC: 0.6865 - Val PR-AUC: 0.4530
[Fine-tune] Epoch 46/50 - Loss: 0.1925 - Val F1: 0.4500 - Val ROC-AUC: 0.6856 - Val PR-AUC: 0.4528
[Fine-tune] Epoch 47/50 - Loss: 0.2269 - Val F1: 0.4337 - Val ROC-AUC: 0.6827 - Val PR-AUC: 0.4557
[Fine-tune] Epoch 48/50 - Loss: 0.2116 - Val F1: 0.4557 - Val ROC-AUC: 0.6897 - Val PR-AUC: 0.4651
[Fine-tune] Epoch 49/50 - Loss: 0.2078 - Val F1: 0.4444 - Val ROC-AUC: 0.6814 - Val PR-AUC: 0.4520
[Fine-tune] Epoch 50/50 - Loss: 0.1928 - Val F1: 0.4375 - Val ROC-AUC: 0.6824 - Val PR-AUC: 0.4623
Finetuning completed. Test F1: 0.4532, ROC-AUC: 0.7382, PR-AUC: 0.4324
[3.1/4] Target-only training on ATG_ERa_TRANS using GIN_GAT...
  * Target-only 모델 이미 존재: model_save/targetonly/gin_gat/TargetOnly_ATG_ERa_TRANS_gin_gat.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.5153, ROC-AUC: 0.7288, PR-AUC: 0.4992
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> ATG_ERa_TRANS [GIN_GAT]
