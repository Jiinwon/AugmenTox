[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERa_LUC_VM7_Agonist using GIN_GAT...
  * Pretrained model already exists at model_save/pretrained/gin_gat/Pretrained_TOX21_ERa_LUC_VM7_Agonist_gin_gat.pth, loading...
[3/4] Finetuning on OT_ER_ERbERb_1440 using GIN_GAT...
[Fine-tune] Epoch 1/50 - Loss: 0.6483 - Val F1: 0.2857 - Val ROC-AUC: 0.7017 - Val PR-AUC: 0.4555
[Fine-tune] Epoch 2/50 - Loss: 0.4804 - Val F1: 0.3836 - Val ROC-AUC: 0.7391 - Val PR-AUC: 0.4422
[Fine-tune] Epoch 3/50 - Loss: 0.4002 - Val F1: 0.3191 - Val ROC-AUC: 0.7444 - Val PR-AUC: 0.4549
[Fine-tune] Epoch 4/50 - Loss: 0.4163 - Val F1: 0.3607 - Val ROC-AUC: 0.7305 - Val PR-AUC: 0.4048
[Fine-tune] Epoch 5/50 - Loss: 0.4116 - Val F1: 0.3056 - Val ROC-AUC: 0.7134 - Val PR-AUC: 0.4401
[Fine-tune] Epoch 6/50 - Loss: 0.3501 - Val F1: 0.3544 - Val ROC-AUC: 0.6907 - Val PR-AUC: 0.3047
[Fine-tune] Epoch 7/50 - Loss: 0.3459 - Val F1: 0.3582 - Val ROC-AUC: 0.7217 - Val PR-AUC: 0.4536
[Fine-tune] Epoch 8/50 - Loss: 0.2974 - Val F1: 0.4314 - Val ROC-AUC: 0.7364 - Val PR-AUC: 0.4477
[Fine-tune] Epoch 9/50 - Loss: 0.2761 - Val F1: 0.3939 - Val ROC-AUC: 0.7059 - Val PR-AUC: 0.4118
[Fine-tune] Epoch 10/50 - Loss: 0.3369 - Val F1: 0.3514 - Val ROC-AUC: 0.6959 - Val PR-AUC: 0.3902
[Fine-tune] Epoch 11/50 - Loss: 0.2704 - Val F1: 0.4068 - Val ROC-AUC: 0.7184 - Val PR-AUC: 0.5064
[Fine-tune] Epoch 12/50 - Loss: 0.2657 - Val F1: 0.3636 - Val ROC-AUC: 0.6810 - Val PR-AUC: 0.4835
[Fine-tune] Epoch 13/50 - Loss: 0.1955 - Val F1: 0.3934 - Val ROC-AUC: 0.7123 - Val PR-AUC: 0.4911
[Fine-tune] Epoch 14/50 - Loss: 0.2165 - Val F1: 0.3934 - Val ROC-AUC: 0.6813 - Val PR-AUC: 0.3878
[Fine-tune] Epoch 15/50 - Loss: 0.1891 - Val F1: 0.4167 - Val ROC-AUC: 0.7175 - Val PR-AUC: 0.4854
[Fine-tune] Epoch 16/50 - Loss: 0.2094 - Val F1: 0.4000 - Val ROC-AUC: 0.6909 - Val PR-AUC: 0.4263
[Fine-tune] Epoch 17/50 - Loss: 0.1888 - Val F1: 0.4314 - Val ROC-AUC: 0.6782 - Val PR-AUC: 0.4983
[Fine-tune] Epoch 18/50 - Loss: 0.1976 - Val F1: 0.4314 - Val ROC-AUC: 0.6729 - Val PR-AUC: 0.4803
[Fine-tune] Epoch 19/50 - Loss: 0.1941 - Val F1: 0.3929 - Val ROC-AUC: 0.6854 - Val PR-AUC: 0.4339
[Fine-tune] Epoch 20/50 - Loss: 0.1836 - Val F1: 0.3793 - Val ROC-AUC: 0.6763 - Val PR-AUC: 0.4516
[Fine-tune] Epoch 21/50 - Loss: 0.1428 - Val F1: 0.3636 - Val ROC-AUC: 0.6594 - Val PR-AUC: 0.4161
[Fine-tune] Epoch 22/50 - Loss: 0.1561 - Val F1: 0.4074 - Val ROC-AUC: 0.6760 - Val PR-AUC: 0.4634
[Fine-tune] Epoch 23/50 - Loss: 0.1404 - Val F1: 0.3571 - Val ROC-AUC: 0.6901 - Val PR-AUC: 0.4625
[Fine-tune] Epoch 24/50 - Loss: 0.1434 - Val F1: 0.4583 - Val ROC-AUC: 0.6965 - Val PR-AUC: 0.5039
[Fine-tune] Epoch 25/50 - Loss: 0.1421 - Val F1: 0.4444 - Val ROC-AUC: 0.6810 - Val PR-AUC: 0.4590
[Fine-tune] Epoch 26/50 - Loss: 0.1320 - Val F1: 0.3571 - Val ROC-AUC: 0.6815 - Val PR-AUC: 0.4799
[Fine-tune] Epoch 27/50 - Loss: 0.1330 - Val F1: 0.3793 - Val ROC-AUC: 0.6680 - Val PR-AUC: 0.4320
[Fine-tune] Epoch 28/50 - Loss: 0.1538 - Val F1: 0.3913 - Val ROC-AUC: 0.6544 - Val PR-AUC: 0.4501
[Fine-tune] Epoch 29/50 - Loss: 0.1423 - Val F1: 0.4000 - Val ROC-AUC: 0.6804 - Val PR-AUC: 0.4473
[Fine-tune] Epoch 30/50 - Loss: 0.1281 - Val F1: 0.4400 - Val ROC-AUC: 0.6729 - Val PR-AUC: 0.4674
[Fine-tune] Epoch 31/50 - Loss: 0.1354 - Val F1: 0.4151 - Val ROC-AUC: 0.6843 - Val PR-AUC: 0.4334
[Fine-tune] Epoch 32/50 - Loss: 0.1089 - Val F1: 0.4314 - Val ROC-AUC: 0.6815 - Val PR-AUC: 0.4227
[Fine-tune] Epoch 33/50 - Loss: 0.0936 - Val F1: 0.4490 - Val ROC-AUC: 0.6849 - Val PR-AUC: 0.4646
[Fine-tune] Epoch 34/50 - Loss: 0.1374 - Val F1: 0.4074 - Val ROC-AUC: 0.6862 - Val PR-AUC: 0.4108
[Fine-tune] Epoch 35/50 - Loss: 0.1166 - Val F1: 0.3922 - Val ROC-AUC: 0.6691 - Val PR-AUC: 0.4292
[Fine-tune] Epoch 36/50 - Loss: 0.0984 - Val F1: 0.4348 - Val ROC-AUC: 0.6815 - Val PR-AUC: 0.4514
[Fine-tune] Epoch 37/50 - Loss: 0.1189 - Val F1: 0.4314 - Val ROC-AUC: 0.6898 - Val PR-AUC: 0.4348
[Fine-tune] Epoch 38/50 - Loss: 0.1135 - Val F1: 0.4490 - Val ROC-AUC: 0.6973 - Val PR-AUC: 0.4505
[Fine-tune] Epoch 39/50 - Loss: 0.1067 - Val F1: 0.3922 - Val ROC-AUC: 0.6771 - Val PR-AUC: 0.4292
[Fine-tune] Epoch 40/50 - Loss: 0.1198 - Val F1: 0.4348 - Val ROC-AUC: 0.6979 - Val PR-AUC: 0.4547
[Fine-tune] Epoch 41/50 - Loss: 0.0962 - Val F1: 0.4167 - Val ROC-AUC: 0.6685 - Val PR-AUC: 0.4587
[Fine-tune] Epoch 42/50 - Loss: 0.0959 - Val F1: 0.4167 - Val ROC-AUC: 0.6752 - Val PR-AUC: 0.4505
[Fine-tune] Epoch 43/50 - Loss: 0.0917 - Val F1: 0.4400 - Val ROC-AUC: 0.6771 - Val PR-AUC: 0.4421
[Fine-tune] Epoch 44/50 - Loss: 0.1147 - Val F1: 0.4167 - Val ROC-AUC: 0.6754 - Val PR-AUC: 0.4384
[Fine-tune] Epoch 45/50 - Loss: 0.0835 - Val F1: 0.4231 - Val ROC-AUC: 0.6729 - Val PR-AUC: 0.4399
[Fine-tune] Epoch 46/50 - Loss: 0.1092 - Val F1: 0.4082 - Val ROC-AUC: 0.6738 - Val PR-AUC: 0.4192
[Fine-tune] Epoch 47/50 - Loss: 0.0877 - Val F1: 0.4400 - Val ROC-AUC: 0.6815 - Val PR-AUC: 0.4321
[Fine-tune] Epoch 48/50 - Loss: 0.0883 - Val F1: 0.4583 - Val ROC-AUC: 0.6810 - Val PR-AUC: 0.4632
[Fine-tune] Epoch 49/50 - Loss: 0.1084 - Val F1: 0.4583 - Val ROC-AUC: 0.6721 - Val PR-AUC: 0.4365
[Fine-tune] Epoch 50/50 - Loss: 0.1003 - Val F1: 0.4783 - Val ROC-AUC: 0.6782 - Val PR-AUC: 0.4412
Finetuning completed. Test F1: 0.3673, ROC-AUC: 0.6765, PR-AUC: 0.3739
[3.1/4] Target-only training on OT_ER_ERbERb_1440 using GIN_GAT...
=== Target-only training ===
[Target-only] Epoch 1/50 – Loss: 0.6442  Val F1: 0.2778  ROC-AUC: 0.6430  PR-AUC: 0.2755
[Target-only] Epoch 2/50 – Loss: 0.5606  Val F1: 0.3529  ROC-AUC: 0.6375  PR-AUC: 0.3194
[Target-only] Epoch 3/50 – Loss: 0.5531  Val F1: 0.2921  ROC-AUC: 0.6339  PR-AUC: 0.4436
[Target-only] Epoch 4/50 – Loss: 0.5089  Val F1: 0.2655  ROC-AUC: 0.6846  PR-AUC: 0.3141
[Target-only] Epoch 5/50 – Loss: 0.5126  Val F1: 0.3077  ROC-AUC: 0.6530  PR-AUC: 0.4096
[Target-only] Epoch 6/50 – Loss: 0.5042  Val F1: 0.3284  ROC-AUC: 0.6846  PR-AUC: 0.4404
[Target-only] Epoch 7/50 – Loss: 0.4897  Val F1: 0.3333  ROC-AUC: 0.6613  PR-AUC: 0.4424
[Target-only] Epoch 8/50 – Loss: 0.4575  Val F1: 0.2800  ROC-AUC: 0.6860  PR-AUC: 0.3493
[Target-only] Epoch 9/50 – Loss: 0.4653  Val F1: 0.3636  ROC-AUC: 0.6716  PR-AUC: 0.2854
[Target-only] Epoch 10/50 – Loss: 0.4712  Val F1: 0.3182  ROC-AUC: 0.6945  PR-AUC: 0.2939
[Target-only] Epoch 11/50 – Loss: 0.4368  Val F1: 0.3056  ROC-AUC: 0.6995  PR-AUC: 0.4548
[Target-only] Epoch 12/50 – Loss: 0.3792  Val F1: 0.3441  ROC-AUC: 0.7034  PR-AUC: 0.4213
[Target-only] Epoch 13/50 – Loss: 0.4360  Val F1: 0.3457  ROC-AUC: 0.7195  PR-AUC: 0.4066
[Target-only] Epoch 14/50 – Loss: 0.3786  Val F1: 0.3294  ROC-AUC: 0.7178  PR-AUC: 0.4545
[Target-only] Epoch 15/50 – Loss: 0.4044  Val F1: 0.4068  ROC-AUC: 0.7137  PR-AUC: 0.4012
[Target-only] Epoch 16/50 – Loss: 0.3785  Val F1: 0.2973  ROC-AUC: 0.7112  PR-AUC: 0.4208
[Target-only] Epoch 17/50 – Loss: 0.3776  Val F1: 0.3729  ROC-AUC: 0.7112  PR-AUC: 0.4449
[Target-only] Epoch 18/50 – Loss: 0.3500  Val F1: 0.2970  ROC-AUC: 0.7228  PR-AUC: 0.4743
[Target-only] Epoch 19/50 – Loss: 0.4182  Val F1: 0.3896  ROC-AUC: 0.7413  PR-AUC: 0.3625
[Target-only] Epoch 20/50 – Loss: 0.3423  Val F1: 0.3273  ROC-AUC: 0.7438  PR-AUC: 0.3813
[Target-only] Epoch 21/50 – Loss: 0.3012  Val F1: 0.3810  ROC-AUC: 0.7101  PR-AUC: 0.4076
[Target-only] Epoch 22/50 – Loss: 0.3008  Val F1: 0.3529  ROC-AUC: 0.7156  PR-AUC: 0.4087
[Target-only] Epoch 23/50 – Loss: 0.2857  Val F1: 0.3636  ROC-AUC: 0.7053  PR-AUC: 0.4312
[Target-only] Epoch 24/50 – Loss: 0.2620  Val F1: 0.3768  ROC-AUC: 0.7383  PR-AUC: 0.4116
[Target-only] Epoch 25/50 – Loss: 0.2864  Val F1: 0.3492  ROC-AUC: 0.7449  PR-AUC: 0.3655
[Target-only] Epoch 26/50 – Loss: 0.2939  Val F1: 0.3939  ROC-AUC: 0.7308  PR-AUC: 0.4957
[Target-only] Epoch 27/50 – Loss: 0.2666  Val F1: 0.3529  ROC-AUC: 0.7325  PR-AUC: 0.4196
[Target-only] Epoch 28/50 – Loss: 0.2584  Val F1: 0.4054  ROC-AUC: 0.7580  PR-AUC: 0.4679
[Target-only] Epoch 29/50 – Loss: 0.2284  Val F1: 0.4194  ROC-AUC: 0.7217  PR-AUC: 0.3915
[Target-only] Epoch 30/50 – Loss: 0.2371  Val F1: 0.3881  ROC-AUC: 0.7375  PR-AUC: 0.4942
[Target-only] Epoch 31/50 – Loss: 0.2395  Val F1: 0.3824  ROC-AUC: 0.7458  PR-AUC: 0.4595
[Target-only] Epoch 32/50 – Loss: 0.2123  Val F1: 0.4478  ROC-AUC: 0.7546  PR-AUC: 0.5001
[Target-only] Epoch 33/50 – Loss: 0.2158  Val F1: 0.4483  ROC-AUC: 0.7350  PR-AUC: 0.4698
[Target-only] Epoch 34/50 – Loss: 0.2353  Val F1: 0.4255  ROC-AUC: 0.7336  PR-AUC: 0.4554
[Target-only] Epoch 35/50 – Loss: 0.2150  Val F1: 0.3810  ROC-AUC: 0.7452  PR-AUC: 0.4670
[Target-only] Epoch 36/50 – Loss: 0.1981  Val F1: 0.4561  ROC-AUC: 0.7425  PR-AUC: 0.4534
[Target-only] Epoch 37/50 – Loss: 0.1895  Val F1: 0.4333  ROC-AUC: 0.7386  PR-AUC: 0.4597
[Target-only] Epoch 38/50 – Loss: 0.2070  Val F1: 0.3810  ROC-AUC: 0.7394  PR-AUC: 0.4554
[Target-only] Epoch 39/50 – Loss: 0.1895  Val F1: 0.4179  ROC-AUC: 0.7436  PR-AUC: 0.5122
[Target-only] Epoch 40/50 – Loss: 0.2038  Val F1: 0.4138  ROC-AUC: 0.7505  PR-AUC: 0.4812
[Target-only] Epoch 41/50 – Loss: 0.1931  Val F1: 0.4074  ROC-AUC: 0.7391  PR-AUC: 0.5038
[Target-only] Epoch 42/50 – Loss: 0.1766  Val F1: 0.3810  ROC-AUC: 0.7402  PR-AUC: 0.4829
[Target-only] Epoch 43/50 – Loss: 0.1845  Val F1: 0.3934  ROC-AUC: 0.7391  PR-AUC: 0.5062
[Target-only] Epoch 44/50 – Loss: 0.1904  Val F1: 0.3934  ROC-AUC: 0.7328  PR-AUC: 0.5064
[Target-only] Epoch 45/50 – Loss: 0.1635  Val F1: 0.3810  ROC-AUC: 0.7350  PR-AUC: 0.4815
[Target-only] Epoch 46/50 – Loss: 0.1919  Val F1: 0.3860  ROC-AUC: 0.7347  PR-AUC: 0.4949
[Target-only] Epoch 47/50 – Loss: 0.1548  Val F1: 0.4444  ROC-AUC: 0.7397  PR-AUC: 0.4744
[Target-only] Epoch 48/50 – Loss: 0.1500  Val F1: 0.3824  ROC-AUC: 0.7394  PR-AUC: 0.4869
[Target-only] Epoch 49/50 – Loss: 0.1621  Val F1: 0.4364  ROC-AUC: 0.7402  PR-AUC: 0.4982
[Target-only] Epoch 50/50 – Loss: 0.1699  Val F1: 0.4062  ROC-AUC: 0.7328  PR-AUC: 0.5044
=== Target-only TEST performance ===
Test F1: 0.4000, ROC-AUC: 0.6763, PR-AUC: 0.2740
✅ 실험 완료: TOX21_ERa_LUC_VM7_Agonist -> OT_ER_ERbERb_1440 [GIN_GAT]
