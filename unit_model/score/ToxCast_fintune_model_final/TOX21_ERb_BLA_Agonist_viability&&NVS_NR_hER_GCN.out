[1/4] Excel → CSV 변환 중...
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist: data/sample/TOX21_ERa_LUC_VM7_Agonist.csv
Saved pretrain CSV for TOX21_ERb_BLA_Agonist_viability: data/sample/TOX21_ERb_BLA_Agonist_viability.csv
Saved pretrain CSV for TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability: data/sample/TOX21_ERa_LUC_VM7_Agonist_10nM_ICI182780_viability.csv
Saved pretrain CSV for TOX21_ERR_LUC_viability: data/sample/TOX21_ERR_LUC_viability.csv
Saved finetune CSV for ATG_ERE_CIS: data/sample/ATG_ERE_CIS.csv
Saved finetune CSV for ATG_ERa_TRANS: data/sample/ATG_ERa_TRANS.csv
Saved finetune CSV for ACEA_ER_80hr: data/sample/ACEA_ER_80hr.csv
Saved finetune CSV for OT_ER_ERaERa_1440: data/sample/OT_ER_ERaERa_1440.csv
Saved finetune CSV for OT_ER_ERaERb_1440: data/sample/OT_ER_ERaERb_1440.csv
Saved finetune CSV for OT_ER_ERbERb_1440: data/sample/OT_ER_ERbERb_1440.csv
Saved finetune CSV for NVS_NR_hER: data/sample/NVS_NR_hER.csv
[2/4] Pretraining on TOX21_ERb_BLA_Agonist_viability using GCN...
  * Pretrained model already exists at model_save/pretrained/gcn/Pretrained_TOX21_ERb_BLA_Agonist_viability_gcn.pth, loading...
[3/4] Finetuning on NVS_NR_hER using GCN...
[Fine-tune] Epoch 1/50 - Loss: 0.6770 - Val F1: 0.4898 - Val ROC-AUC: 0.7867 - Val PR-AUC: 0.4686
[Fine-tune] Epoch 2/50 - Loss: 0.6147 - Val F1: 0.4545 - Val ROC-AUC: 0.7686 - Val PR-AUC: 0.5337
[Fine-tune] Epoch 3/50 - Loss: 0.5633 - Val F1: 0.4727 - Val ROC-AUC: 0.8130 - Val PR-AUC: 0.6300
[Fine-tune] Epoch 4/50 - Loss: 0.5366 - Val F1: 0.4444 - Val ROC-AUC: 0.7615 - Val PR-AUC: 0.5069
[Fine-tune] Epoch 5/50 - Loss: 0.5389 - Val F1: 0.5106 - Val ROC-AUC: 0.8087 - Val PR-AUC: 0.5569
[Fine-tune] Epoch 6/50 - Loss: 0.5018 - Val F1: 0.5882 - Val ROC-AUC: 0.8262 - Val PR-AUC: 0.5752
[Fine-tune] Epoch 7/50 - Loss: 0.5034 - Val F1: 0.4225 - Val ROC-AUC: 0.7889 - Val PR-AUC: 0.5559
[Fine-tune] Epoch 8/50 - Loss: 0.4869 - Val F1: 0.4400 - Val ROC-AUC: 0.8065 - Val PR-AUC: 0.6408
[Fine-tune] Epoch 9/50 - Loss: 0.4732 - Val F1: 0.5217 - Val ROC-AUC: 0.8196 - Val PR-AUC: 0.6396
[Fine-tune] Epoch 10/50 - Loss: 0.4811 - Val F1: 0.4839 - Val ROC-AUC: 0.8065 - Val PR-AUC: 0.5821
[Fine-tune] Epoch 11/50 - Loss: 0.4728 - Val F1: 0.5600 - Val ROC-AUC: 0.8114 - Val PR-AUC: 0.6217
[Fine-tune] Epoch 12/50 - Loss: 0.4755 - Val F1: 0.4483 - Val ROC-AUC: 0.8048 - Val PR-AUC: 0.5873
[Fine-tune] Epoch 13/50 - Loss: 0.4661 - Val F1: 0.4906 - Val ROC-AUC: 0.8032 - Val PR-AUC: 0.6438
[Fine-tune] Epoch 14/50 - Loss: 0.4573 - Val F1: 0.4231 - Val ROC-AUC: 0.7950 - Val PR-AUC: 0.6183
[Fine-tune] Epoch 15/50 - Loss: 0.4762 - Val F1: 0.4706 - Val ROC-AUC: 0.8010 - Val PR-AUC: 0.6321
[Fine-tune] Epoch 16/50 - Loss: 0.4535 - Val F1: 0.5085 - Val ROC-AUC: 0.8065 - Val PR-AUC: 0.6265
[Fine-tune] Epoch 17/50 - Loss: 0.4444 - Val F1: 0.4681 - Val ROC-AUC: 0.7993 - Val PR-AUC: 0.6276
[Fine-tune] Epoch 18/50 - Loss: 0.4458 - Val F1: 0.5000 - Val ROC-AUC: 0.8180 - Val PR-AUC: 0.6548
[Fine-tune] Epoch 19/50 - Loss: 0.4491 - Val F1: 0.4364 - Val ROC-AUC: 0.8043 - Val PR-AUC: 0.6451
[Fine-tune] Epoch 20/50 - Loss: 0.4415 - Val F1: 0.5000 - Val ROC-AUC: 0.8070 - Val PR-AUC: 0.6464
[Fine-tune] Epoch 21/50 - Loss: 0.4205 - Val F1: 0.4906 - Val ROC-AUC: 0.8098 - Val PR-AUC: 0.6383
[Fine-tune] Epoch 22/50 - Loss: 0.4141 - Val F1: 0.4815 - Val ROC-AUC: 0.8076 - Val PR-AUC: 0.6359
[Fine-tune] Epoch 23/50 - Loss: 0.4134 - Val F1: 0.4815 - Val ROC-AUC: 0.8109 - Val PR-AUC: 0.6430
[Fine-tune] Epoch 24/50 - Loss: 0.4139 - Val F1: 0.4643 - Val ROC-AUC: 0.8147 - Val PR-AUC: 0.6374
[Fine-tune] Epoch 25/50 - Loss: 0.4105 - Val F1: 0.4444 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.6343
[Fine-tune] Epoch 26/50 - Loss: 0.4352 - Val F1: 0.4286 - Val ROC-AUC: 0.8218 - Val PR-AUC: 0.6321
[Fine-tune] Epoch 27/50 - Loss: 0.4327 - Val F1: 0.5385 - Val ROC-AUC: 0.8246 - Val PR-AUC: 0.6595
[Fine-tune] Epoch 28/50 - Loss: 0.4113 - Val F1: 0.4800 - Val ROC-AUC: 0.8213 - Val PR-AUC: 0.6462
[Fine-tune] Epoch 29/50 - Loss: 0.4200 - Val F1: 0.4444 - Val ROC-AUC: 0.8152 - Val PR-AUC: 0.6191
[Fine-tune] Epoch 30/50 - Loss: 0.4051 - Val F1: 0.4082 - Val ROC-AUC: 0.8125 - Val PR-AUC: 0.6019
[Fine-tune] Epoch 31/50 - Loss: 0.4361 - Val F1: 0.5091 - Val ROC-AUC: 0.8268 - Val PR-AUC: 0.6548
[Fine-tune] Epoch 32/50 - Loss: 0.3872 - Val F1: 0.4706 - Val ROC-AUC: 0.8136 - Val PR-AUC: 0.6361
[Fine-tune] Epoch 33/50 - Loss: 0.3855 - Val F1: 0.4528 - Val ROC-AUC: 0.8141 - Val PR-AUC: 0.6445
[Fine-tune] Epoch 34/50 - Loss: 0.4135 - Val F1: 0.4400 - Val ROC-AUC: 0.8141 - Val PR-AUC: 0.6437
[Fine-tune] Epoch 35/50 - Loss: 0.3772 - Val F1: 0.4706 - Val ROC-AUC: 0.8043 - Val PR-AUC: 0.6238
[Fine-tune] Epoch 36/50 - Loss: 0.4160 - Val F1: 0.4615 - Val ROC-AUC: 0.8152 - Val PR-AUC: 0.6481
[Fine-tune] Epoch 37/50 - Loss: 0.4010 - Val F1: 0.4800 - Val ROC-AUC: 0.8202 - Val PR-AUC: 0.6448
[Fine-tune] Epoch 38/50 - Loss: 0.3897 - Val F1: 0.5000 - Val ROC-AUC: 0.8268 - Val PR-AUC: 0.6575
[Fine-tune] Epoch 39/50 - Loss: 0.4026 - Val F1: 0.4490 - Val ROC-AUC: 0.8141 - Val PR-AUC: 0.6350
[Fine-tune] Epoch 40/50 - Loss: 0.4064 - Val F1: 0.4490 - Val ROC-AUC: 0.8141 - Val PR-AUC: 0.6448
[Fine-tune] Epoch 41/50 - Loss: 0.4195 - Val F1: 0.4706 - Val ROC-AUC: 0.8158 - Val PR-AUC: 0.6459
[Fine-tune] Epoch 42/50 - Loss: 0.4045 - Val F1: 0.4800 - Val ROC-AUC: 0.8120 - Val PR-AUC: 0.6472
[Fine-tune] Epoch 43/50 - Loss: 0.4064 - Val F1: 0.4583 - Val ROC-AUC: 0.8130 - Val PR-AUC: 0.6490
[Fine-tune] Epoch 44/50 - Loss: 0.4205 - Val F1: 0.4615 - Val ROC-AUC: 0.8163 - Val PR-AUC: 0.6460
[Fine-tune] Epoch 45/50 - Loss: 0.3745 - Val F1: 0.4706 - Val ROC-AUC: 0.8098 - Val PR-AUC: 0.6270
[Fine-tune] Epoch 46/50 - Loss: 0.3807 - Val F1: 0.4490 - Val ROC-AUC: 0.8081 - Val PR-AUC: 0.6187
[Fine-tune] Epoch 47/50 - Loss: 0.4083 - Val F1: 0.4615 - Val ROC-AUC: 0.8076 - Val PR-AUC: 0.6272
[Fine-tune] Epoch 48/50 - Loss: 0.4107 - Val F1: 0.4898 - Val ROC-AUC: 0.8103 - Val PR-AUC: 0.6442
[Fine-tune] Epoch 49/50 - Loss: 0.4128 - Val F1: 0.4815 - Val ROC-AUC: 0.8185 - Val PR-AUC: 0.6483
[Fine-tune] Epoch 50/50 - Loss: 0.3917 - Val F1: 0.5000 - Val ROC-AUC: 0.8169 - Val PR-AUC: 0.6482
Finetuning completed. Test F1: 0.4706, ROC-AUC: 0.7786, PR-AUC: 0.4884
[3.1/4] Target-only training on NVS_NR_hER using GCN...
  * Target-only 모델 이미 존재: model_save/targetonly/gcn/TargetOnly_NVS_NR_hER_gcn.pth
  * Target-only 생략, 저장된 모델로 평가만 진행
=== Target-only TEST performance ===
Test F1: 0.4681, ROC-AUC: 0.7851, PR-AUC: 0.4841
✅ 실험 완료: TOX21_ERb_BLA_Agonist_viability -> NVS_NR_hER [GCN]
